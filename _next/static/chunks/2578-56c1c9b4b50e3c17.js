"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2578],{32578:function(e,n,r){r.d(n,{$A:function(){return A},Ag:function(){return g},G8:function(){return U},MD:function(){return y},R5:function(){return p},c:function(){return v},dh:function(){return h},fq:function(){return m},lM:function(){return L},tw:function(){return b},y0:function(){return E}});r(93889);var t=r(78394),s=r(30121),i=r(10308),u=r(67781),o=r(69009),a=r(5766),c=r(79400),l=r(90426),f=r(49631),d=(r(61564),r(21242)),w=r(6403);const y="authUserInvalidation",p={session:[d.r],publicUser:e=>[y,"publicUser",e],votedApps:(e,n)=>["votedApps",e,n],followedApps:(e,n)=>["followedApps",e,n],reviews:function(e){let{limit:n=c.yT,type:r="all",period:t="all"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["userReviews",e,{limit:n,type:r,period:t}]},review:(e,n)=>[y,"userReview",e,n],humanityScore:[d.f,"humanityScore"],checkMagicIDNecessaryData:e=>[d.f,"checkMagicIDNecessaryData",e],referralUrl:(e,n)=>[d.f,"referralUrl",e,n],faceLivenessSession:[d.f,"faceLivenessSession"],faceLivenessSessionResult:e=>[d.f,"faceLivenessSession",e],xLoginUrl:e=>[d.f,"xLoginUrl",e],discordLoginUrl:e=>[d.f,"discordLoginUrl",e]},v=()=>{const e=(0,t.useQueryClient)();return(0,s.useMutation)({mutationFn:()=>(0,o.Red)(),onSuccess:()=>{e.invalidateQueries({queryKey:[p.session]})}})},R=e=>()=>{const n=(0,t.useQueryClient)();return(0,s.useMutation)({mutationFn:async n=>{const r=u.Z.get(l.Z.REFERRAL),t=await e({json:{...n,referredBy:r}});return{...await(0,o.isw)(),isNewUser:t.newUser}},onSuccess:e=>{u.Z.remove(l.Z.REFERRAL),(0,w.aJ)(n,e)}})},g=(R(o.bLH),R(o.wkY),R(o.bq_),R(o.nEx)),m=R((e=>(0,o.jbP)(e))),U=R(o.WTo),E=R(o.o1R),L=()=>{const e=(0,t.useQueryClient)();return(0,s.useMutation)({mutationFn:async e=>{let{address:n,signature:r,network:t,message:s,walletType:i,v2:c}=e;const f=await(0,o.Dkb)({json:{pub_key:n,signature:r,network:t,message:s,wallet:i.toUpperCase()},...c?{headers:{"x-sign-in":"v2"}}:{}});if(f.error)throw new Error("Login failed");const d=u.Z.get(l.Z.REFERRAL);if((await(0,a.z7)({json:{network:t,pub_key:n,wallet:i,referredBy:d}})).error)throw new Error("Connect failed");return{user:await(0,o.isw)(),isNewUser:f.newUser}},onSuccess:n=>{e.invalidateQueries({queryKey:[d.f]}),(0,w.aJ)(e,n.user)}})},A=(e,n)=>(0,i.useQuery)({queryFn:()=>(0,o.qtm)({from:e}),queryKey:p.xLoginUrl(e),...n}),h=(e,n)=>(0,i.useQuery)({queryKey:p.discordLoginUrl(e),queryFn:()=>(0,o.ZMW)({from:e}),...n}),b=()=>{const e=(0,t.useQueryClient)(),{webApp:n}=(0,f.default)();return(0,s.useMutation)({mutationFn:async e=>{const r=u.Z.get(l.Z.REFERRAL),t=await(0,o.VIF)({json:{...e,referredBy:r}});u.Z.remove(l.Z.REFERRAL);const s=await(0,o.isw)();null==s||s.socials.find((e=>"TELEGRAM"===e.type)),null==n||n.initDataUnsafe.user;return{user:s,isNewUser:t.newUser}},onSuccess:n=>{(0,w.aJ)(e,n.user)}})}},61564:function(e,n,r){r.d(n,{N:function(){return i}});var t=r(8512);const s={},i=()=>{const{data:e=s}=(0,t.XX)();return e}},49631:function(e,n,r){var t=r(93889);n.default=()=>{const[e,n]=(0,t.useState)(void 0),[r,s]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{const e=()=>{var e,r;const t=null===(r=window)||void 0===r||null===(e=r.Telegram)||void 0===e?void 0:e.WebApp;return!!t&&(t.ready(),n(t),!0)};if(e())return;let r;const t=setTimeout((()=>{s(!0),clearInterval(r)}),1e4);return r=setInterval((()=>{e()&&(clearInterval(r),clearTimeout(t))}),1e3),()=>{clearInterval(r),clearTimeout(t)}}),[]),{webApp:e,isAppOpenedInTelegram:Boolean(null==e?void 0:e.initData),hasTimedOut:r}}}}]);
//# sourceMappingURL=2578-56c1c9b4b50e3c17.js.map