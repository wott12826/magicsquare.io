"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1199],{4155:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,r)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return r(t,e),t},o=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{c(s.next(e))}catch(e){n(e)}}function a(e){try{c(s.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SiweMessage=void 0;const a=i(1792),c=n(i(7117)),h=i(60973),d=i(73118),u=i(69814);t.SiweMessage=class{constructor(e){if("string"==typeof e){const t=new a.ParsedMessage(e);this.scheme=t.scheme,this.domain=t.domain,this.address=t.address,this.statement=t.statement,this.uri=t.uri,this.version=t.version,this.nonce=t.nonce,this.issuedAt=t.issuedAt,this.expirationTime=t.expirationTime,this.notBefore=t.notBefore,this.requestId=t.requestId,this.chainId=t.chainId,this.resources=t.resources}else this.scheme=null==e?void 0:e.scheme,this.domain=e.domain,this.address=e.address,this.statement=null==e?void 0:e.statement,this.uri=e.uri,this.version=e.version,this.chainId=e.chainId,this.nonce=e.nonce,this.issuedAt=null==e?void 0:e.issuedAt,this.expirationTime=null==e?void 0:e.expirationTime,this.notBefore=null==e?void 0:e.notBefore,this.requestId=null==e?void 0:e.requestId,this.resources=null==e?void 0:e.resources,"string"==typeof this.chainId&&(this.chainId=(0,a.parseIntegerNumber)(this.chainId));this.nonce=this.nonce||(0,u.generateNonce)(),this.validateMessage()}toMessage(){this.validateMessage();const e=`${this.scheme?`${this.scheme}://${this.domain}`:this.domain} wants you to sign in with your Ethereum account:`,t=`URI: ${this.uri}`;let i=[e,this.address].join("\n");const s=`Version: ${this.version}`;this.nonce||(this.nonce=(0,u.generateNonce)());const r=[t,s,"Chain ID: "+this.chainId||0,`Nonce: ${this.nonce}`];if(this.issuedAt=this.issuedAt||(new Date).toISOString(),r.push(`Issued At: ${this.issuedAt}`),this.expirationTime){const e=`Expiration Time: ${this.expirationTime}`;r.push(e)}this.notBefore&&r.push(`Not Before: ${this.notBefore}`),this.requestId&&r.push(`Request ID: ${this.requestId}`),this.resources&&r.push(["Resources:",...this.resources.map((e=>`- ${e}`))].join("\n"));const n=r.join("\n");return i=[i,this.statement].join("\n\n"),this.statement&&(i+="\n"),[i,n].join("\n")}prepareMessage(){let e;return this.version,e=this.toMessage(),e}validate(e,t){return o(this,void 0,void 0,(function*(){return console.warn("validate() has been deprecated, please update your code to use verify(). validate() may be removed in future versions."),this.verify({signature:e},{provider:t,suppressExceptions:!1}).then((({data:e})=>e)).catch((({error:e})=>{throw e}))}))}verify(e,t={suppressExceptions:!1}){return o(this,void 0,void 0,(function*(){return new Promise(((i,s)=>{var r,n,o;const a=e=>t.suppressExceptions?i(e):s(e),c=(0,u.checkInvalidKeys)(e,d.VerifyParamsKeys);c.length>0&&a({success:!1,data:this,error:new Error(`${c.join(", ")} is/are not valid key(s) for VerifyParams.`)});const l=(0,u.checkInvalidKeys)(t,d.VerifyOptsKeys);c.length>0&&a({success:!1,data:this,error:new Error(`${l.join(", ")} is/are not valid key(s) for VerifyOpts.`)});const{signature:f,scheme:p,domain:v,nonce:I,time:S}=e;p&&p!==this.scheme&&a({success:!1,data:this,error:new d.SiweError(d.SiweErrorType.SCHEME_MISMATCH,p,this.scheme)}),v&&v!==this.domain&&a({success:!1,data:this,error:new d.SiweError(d.SiweErrorType.DOMAIN_MISMATCH,v,this.domain)}),I&&I!==this.nonce&&a({success:!1,data:this,error:new d.SiweError(d.SiweErrorType.NONCE_MISMATCH,I,this.nonce)});const w=new Date(S||new Date);if(this.expirationTime){const e=new Date(this.expirationTime);w.getTime()>=e.getTime()&&a({success:!1,data:this,error:new d.SiweError(d.SiweErrorType.EXPIRED_MESSAGE,`${w.toISOString()} < ${e.toISOString()}`,`${w.toISOString()} >= ${e.toISOString()}`)})}if(this.notBefore){const e=new Date(this.notBefore);w.getTime()<e.getTime()&&a({success:!1,data:this,error:new d.SiweError(d.SiweErrorType.NOT_YET_VALID_MESSAGE,`${w.toISOString()} >= ${e.toISOString()}`,`${w.toISOString()} < ${e.toISOString()}`)})}let E,g;try{E=this.prepareMessage()}catch(e){a({success:!1,data:this,error:e})}try{g=(0,h.verifyMessage)(E,f)}catch(e){console.error(e)}if(g===this.address)return i({success:!0,data:this});{const s=(0,u.checkContractWalletSignature)(this,f,t.provider).then((e=>e?{success:!0,data:this}:{success:!1,data:this,error:new d.SiweError(d.SiweErrorType.INVALID_SIGNATURE,g,`Resolved address to be ${this.address}`)})).catch((e=>({success:!1,data:this,error:e})));Promise.all([s,null===(o=null===(n=null===(r=null==t?void 0:t.verificationFallback)||void 0===r?void 0:r.call(t,e,t,this,s))||void 0===n?void 0:n.then((e=>e)))||void 0===o?void 0:o.catch((e=>e))]).then((([e,t])=>{if(t){if(t.success)return i(t);a(t)}else{if(e.success)return i(e);a(e)}}))}}))}))}validateMessage(...e){var t;if(e.length>0)throw new d.SiweError(d.SiweErrorType.UNABLE_TO_PARSE,"Unexpected argument in the validateMessage function.");if(!this.domain||0===this.domain.length||!/[^#?]*/.test(this.domain))throw new d.SiweError(d.SiweErrorType.INVALID_DOMAIN,`${this.domain} to be a valid domain.`);if(!(0,a.isEIP55Address)(this.address))throw new d.SiweError(d.SiweErrorType.INVALID_ADDRESS,(0,h.getAddress)(this.address),this.address);if(!c.isUri(this.uri))throw new d.SiweError(d.SiweErrorType.INVALID_URI,`${this.uri} to be a valid uri.`);if("1"!==this.version)throw new d.SiweError(d.SiweErrorType.INVALID_MESSAGE_VERSION,"1",this.version);const i=null===(t=null==this?void 0:this.nonce)||void 0===t?void 0:t.match(/[a-zA-Z0-9]{8,}/);if(!i||this.nonce.length<8||i[0]!==this.nonce)throw new d.SiweError(d.SiweErrorType.INVALID_NONCE,`Length > 8 (${i.length}). Alphanumeric.`,this.nonce);if(this.issuedAt&&!(0,u.isValidISO8601Date)(this.issuedAt))throw new Error(d.SiweErrorType.INVALID_TIME_FORMAT);if(this.expirationTime&&!(0,u.isValidISO8601Date)(this.expirationTime))throw new Error(d.SiweErrorType.INVALID_TIME_FORMAT);if(this.notBefore&&!(0,u.isValidISO8601Date)(this.notBefore))throw new Error(d.SiweErrorType.INVALID_TIME_FORMAT)}}},60973:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.getAddress=t.hashMessage=t.verifyMessage=void 0;const s=i(68023);let r=null,n=null,o=null;try{r=s.ethers.utils.verifyMessage,n=s.ethers.utils.hashMessage,o=s.ethers.utils.getAddress}catch(e){r=s.ethers.verifyMessage,n=s.ethers.hashMessage,o=s.ethers.getAddress}t.verifyMessage=r,t.hashMessage=n,t.getAddress=o},81199:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,r)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(4155),t),r(i(73118),t),r(i(69814),t)},73118:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SiweErrorType=t.SiweError=t.VerifyOptsKeys=t.VerifyParamsKeys=void 0,t.VerifyParamsKeys=["signature","scheme","domain","nonce","time"],t.VerifyOptsKeys=["provider","suppressExceptions","verificationFallback"];t.SiweError=class{constructor(e,t,i){this.type=e,this.expected=t,this.received=i}},function(e){e.EXPIRED_MESSAGE="Expired message.",e.INVALID_DOMAIN="Invalid domain.",e.SCHEME_MISMATCH="Scheme does not match provided scheme for verification.",e.DOMAIN_MISMATCH="Domain does not match provided domain for verification.",e.NONCE_MISMATCH="Nonce does not match provided nonce for verification.",e.INVALID_ADDRESS="Invalid address.",e.INVALID_URI="URI does not conform to RFC 3986.",e.INVALID_NONCE="Nonce size smaller then 8 characters or is not alphanumeric.",e.NOT_YET_VALID_MESSAGE="Message is not valid yet.",e.INVALID_SIGNATURE="Signature does not match address of the message.",e.INVALID_TIME_FORMAT="Invalid time format.",e.INVALID_MESSAGE_VERSION="Invalid message version.",e.UNABLE_TO_PARSE="Unable to parse the message."}(t.SiweErrorType||(t.SiweErrorType={}))},69814:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{c(s.next(e))}catch(e){n(e)}}function a(e){try{c(s.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.checkInvalidKeys=t.isValidISO8601Date=t.generateNonce=t.checkContractWalletSignature=void 0;const r=i(73250),n=i(68023),o=i(60973),a=["function isValidSignature(bytes32 _message, bytes _signature) public view returns (bytes4)"],c=/^(?<date>[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01]))[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(.[0-9]+)?(([Zz])|([+|-]([01][0-9]|2[0-3]):[0-5][0-9]))$/;t.checkContractWalletSignature=(e,t,i)=>s(void 0,void 0,void 0,(function*(){if(!i)return!1;const s=new n.Contract(e.address,a,i),r=(0,o.hashMessage)(e.prepareMessage());return"0x1626ba7e"===(yield s.isValidSignature(r,t))}));t.generateNonce=()=>{const e=(0,r.randomStringForEntropy)(96);if(!e||e.length<8)throw new Error("Error during nonce creation.");return e};t.isValidISO8601Date=e=>{const t=c.exec(e);if(!e)return!1;const i=new Date(t.groups.date).toISOString(),s=c.exec(i);return t.groups.date===s.groups.date};t.checkInvalidKeys=(e,t)=>{const i=[];return Object.keys(e).forEach((e=>{t.includes(e)||i.push(e)})),i}}}]);
//# sourceMappingURL=1199-9cfbe26eb06be57d.js.map