"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2578],{32578:function(e,n,t){t.d(n,{Ag:function(){return S},LF:function(){return T},Lc:function(){return L},MD:function(){return w},Np:function(){return F},Q3:function(){return E},R5:function(){return h},c:function(){return p},hD:function(){return Q},ko:function(){return k},lM:function(){return b},qf:function(){return R},tN:function(){return C},yp:function(){return U}});var r=t(93889),s=t(78394),i=t(30121),a=t(10308),u=t(67781),o=t(69009),c=t(5766),l=t(79400),d=t(90426),f=(t(49631),t(94095)),y=t(61564),m=t(21242),v=t(6403);const w="authUserInvalidation",h={session:[m.r],publicUser:e=>[w,"publicUser",e],votedApps:(e,n)=>["votedApps",e,n],followedApps:(e,n)=>["followedApps",e,n],reviews:function(e){let{limit:n=l.yT,type:t="all",period:r="all"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["userReviews",e,{limit:n,type:t,period:r}]},review:(e,n)=>[w,"userReview",e,n],humanityScore:[m.f,"humanityScore"],checkMagicIDNecessaryData:e=>[m.f,"checkMagicIDNecessaryData",e],referralUrl:(e,n)=>[m.f,"referralUrl",e,n],faceLivenessSession:[m.f,"faceLivenessSession"],faceLivenessSessionResult:e=>[m.f,"faceLivenessSession",e],xLoginUrl:e=>[m.f,"xLoginUrl",e],discordLoginUrl:e=>[m.f,"discordLoginUrl",e]},p=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:()=>(0,o.Red)(),onSuccess:()=>{e.invalidateQueries({queryKey:[h.session]})}})},g=e=>()=>{const n=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async n=>{const t=u.Z.get(d.Z.REFERRAL),r=await e({json:{...n,referredBy:t}});return{...await(0,o.isw)(),isNewUser:r.newUser}},onSuccess:e=>{u.Z.remove(d.Z.REFERRAL),(0,v.aJ)(n,e)}})},S=(g(o.bLH),g(o.wkY),g(o.bq_),g(o.nEx)),b=(g((e=>(0,o.jbP)(e))),g(o.WTo),g(o.o1R),()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>{let{address:n,signature:t,network:r,message:s,walletType:i,v2:a}=e;const l=await(0,o.Dkb)({json:{pub_key:n,signature:t,network:r,message:s,wallet:i.toUpperCase()},...a?{headers:{"x-sign-in":"v2"}}:{}});if(l.error)throw new Error("Login failed");const f=u.Z.get(d.Z.REFERRAL);if((await(0,c.z7)({json:{network:r,pub_key:n,wallet:i,referredBy:f}})).error)throw new Error("Connect failed");return{user:await(0,o.isw)(),isNewUser:l.newUser}},onSuccess:n=>{e.invalidateQueries({queryKey:[m.f]}),(0,v.aJ)(e,n.user)}})}),C=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>(await(0,l.ry)({json:e}),(0,o.isw)()),onSuccess:n=>{(0,v.aJ)(e,n)}})},k=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>(await(0,o.eYl)({json:{name:e}}),e),onSuccess:n=>{(0,v._e)(e,{attributes:{name:n}})}})},E=e=>(0,a.useQuery)({queryKey:["checkUserName",e],queryFn:async()=>{if(!e)return{message:"Username is required",isValid:!1};if(!/^[a-zA-Z0-9_]{4,20}$/.test(e))return{message:'The username must contain only Latin letters, numbers and the symbol "_". It must be at least 4 characters and not more than 20',isValid:!1};try{return await(0,l.yE)({json:{name:e}}),{message:"This username is available for use. Please note, your username cannot be changed in the future.",isValid:!0}}catch(e){return{message:(0,f.e)(e),isValid:!1}}},gcTime:2e3,staleTime:1e3,enabled:Boolean(e)}),F=(e,n)=>(0,a.useQuery)({queryKey:[m.f,"sendVerificationCode",e],queryFn:()=>(0,o.lFc)({json:{email:e}}),...n}),L=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>(await(0,l.VT)({json:{...e,code:Number(e.code)}}),e.email),onSuccess:n=>{(0,v._e)(e,{attributes:{email:n}})}})},R=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:()=>(0,l.UO)(),onSuccess:()=>{(0,v._e)(e,{attributes:{email:""}})}})},T=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>(await(0,c.tJ)({id:e}),(0,o.isw)()),onSuccess:n=>{(0,v.aJ)(e,n)}})},U=e=>{var n,t;const s=(0,y.N)(),i=(0,a.useQuery)({queryKey:h.humanityScore,queryFn:()=>(0,l.vL)({searchParams:{humanityScore:1,faceCheckPassed:1}}),select:e=>{var n;return{gitCoin:null==e||null===(n=e.description)||void 0===n?void 0:n.humanityScore,faceCheckPassed:e.description.faceCheckPassed}},gcTime:0,staleTime:0,...e}),u=null===(n=i.data)||void 0===n?void 0:n.gitCoin,o=null===(t=i.data)||void 0===t?void 0:t.faceCheckPassed,c=(0,r.useMemo)((()=>{let e="",n="";return s.humanityVerification&&("number"!=typeof(null==u?void 0:u.score)?e="Connect your Gitcoin Passport":u.acceptable||(e="Insufficient Gitcoin Passport Score.\nRaise to ".concat(u.threshold," to collect rewards."))),s.livenessVerification&&!1===o&&(n="Pass liveliness verification"),s.humanityVerification&&s.livenessVerification?e&&n?{humanityScoreError:e+" OR "+n}:{humanityScoreError:""}:s.livenessVerification?{humanityScoreError:n}:{humanityScoreError:e}}),[s.humanityVerification,s.livenessVerification,i.data]);return{...i,customErrors:c}},Q=()=>{const e=(0,s.useQueryClient)();return(0,i.useMutation)({mutationFn:async e=>{const n=await(0,l.zT)({json:e});return{user:await(0,o.isw)(),walletAddress:n.address}},onSuccess:n=>{(0,v.aJ)(e,n.user)}})}},61564:function(e,n,t){t.d(n,{N:function(){return i}});var r=t(8512);const s={},i=()=>{const{data:e=s}=(0,r.XX)();return e}},49631:function(e,n,t){var r=t(93889);n.default=()=>{const[e,n]=(0,r.useState)(void 0),[t,s]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const e=()=>{var e,t;const r=null===(t=window)||void 0===t||null===(e=t.Telegram)||void 0===e?void 0:e.WebApp;return!!r&&(r.ready(),n(r),!0)};if(e())return;let t;const r=setTimeout((()=>{s(!0),clearInterval(t)}),1e4);return t=setInterval((()=>{e()&&(clearInterval(t),clearTimeout(r))}),1e3),()=>{clearInterval(t),clearTimeout(r)}}),[]),{webApp:e,isAppOpenedInTelegram:Boolean(null==e?void 0:e.initData),hasTimedOut:t}}}}]);
//# sourceMappingURL=2578-f67b33a03d183132.js.map