"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1749],{87907:function(e,t,n){n.d(t,{H:function(){return o},P:function(){return a}});const a=e=>"bigint"==typeof e?Number(e*BigInt(1e3)):1e3*e,o=()=>(new Date).valueOf()},52338:function(e,t,n){n.d(t,{K$:function(){return o},g0:function(){return a}});n(65111);const a=(e,t)=>e?"".concat(e).replace(new RegExp("(\\.\\d{".concat(t,"})\\d+")),"$1"):"0",o=function(e){let{locale:t="en-US",options:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"!=typeof e?"":new Intl.NumberFormat(t,{roundingMode:"trunc",maximumFractionDigits:2,...n}).format(e)}},81807:function(e,t,n){n.d(t,{cO:function(){return E},z3:function(){return N},M3:function(){return y},Bp:function(){return W}});var a=n(74499),o=n(6843),r=n(8531),s=n(81815),i=n(81395),l=n(79022),c=n(67330),d=n(61238),u=n(35276),f=n(62814),m=n(74999),h=n(24952),p=n(97466),g=n(91843);var w=n(27183),b=n(15516),v=n(8411);const y=()=>{const{checkIsEnoughDepositAllowance:e}=(()=>{const{connectWallet:e}=(0,p.default)(),{getUserWalletType:t}=(0,g.Z)(),n=async a=>{const{tokenDecimals:p,amount:g,chainId:w,spenderAddress:b,tokenAddress:v}=a,{walletType:y,userWallet:k}=t(),A=Date.now();try{o.toast.loading("Checking the deposit allowance...",{toastId:A,style:(0,h.Z)(y)});const e=await(0,r.L)(i.g,{abi:l.w6.abi,address:v,functionName:"allowance",chainId:w,args:[k.attributes.address,b]}),t=s.O$.from(e||"0"),n=(0,m.o)(g,p);return t.gte(n)}catch(t){const o=async()=>(await e({walletType:y,targetAddress:k.attributes.address}),n(a));if((0,d.S)(t).message===c.dT.CONNECTOR_NOT_FOUND)return(0,f.Z)(),await o();(0,u.Z)({error:t,unknownExceptionReplaceMessage:c.dT.UNKNOWN_TRANSACTION_ERROR})}finally{o.toast.dismiss(A)}};return{checkIsEnoughDepositAllowance:n}})(),{approve:t}=(()=>{const{connectWallet:e}=(0,p.default)(),{getUserWalletType:t}=(0,g.Z)(),n=async a=>{const{amount:r,chainId:s,spenderAddress:u,tokenAddress:h,tokenDecimals:p}=a,g=Date.now();try{const{request:e}=await(0,w.a)(i.g,{abi:l.w6.abi,address:h,functionName:"approve",chainId:s,gas:BigInt(3e5),args:[u,(0,m.o)(r,p).toBigInt()]}),{walletType:n,userWallet:a}=t();return await Promise.race([(0,b.n)(i.g,e),(0,v.Z)({walletType:n,address:a.attributes.address,toastId:g,title:"Approving transaction..."})])}catch(o){const r=(0,d.S)(o),s=async()=>{const{walletType:o,userWallet:r}=t();return await e({walletType:o,targetAddress:r.attributes.address}),n(a)};if(r.message===c.dT.CONNECTOR_NOT_FOUND)return(0,f.Z)(),await s();if(r.message===c.dT.RETRY)return await n(a);throw o}finally{o.toast.dismiss(g)}};return{approve:n}})(),n=async o=>{let{amount:r,chainId:s,spenderAddress:i,tokenAddress:l,tokenDecimals:c,amountToCheck:d=r}=o;const u=await e({amount:d,chainId:s,spenderAddress:i,tokenAddress:l,tokenDecimals:c});if(void 0!==u&&!u){const e=await t({amount:r,chainId:s,spenderAddress:i,tokenAddress:l,tokenDecimals:c});if(!e)return;await(0,a.N)(e,s),await n({amount:r,chainId:s,spenderAddress:i,tokenAddress:l,tokenDecimals:c})}};return{approveIfNeeded:n}};var k=n(10308);var A=n(44812),I=n(41979);async function N(e){let{tokenAddress:t,chainId:n=c.VQ.id}=e;if(!t)return;const[a,o,r]=await(0,A.J)(i.g,{allowFailure:!1,contracts:[{address:t,abi:I.Wo,functionName:"decimals",chainId:n},{address:t,abi:I.Wo,functionName:"name",chainId:n},{address:t,abi:I.Wo,functionName:"symbol",chainId:n}]});return{address:t,decimals:a,name:o,symbol:r}}var T=n(90650);const C="tokenBalance",E=()=>[C],x=e=>{let{tokenAddress:t,walletAddress:n,chainId:a,enabled:o}=e;return(0,k.useQuery)({queryKey:[C,n,t,a],queryFn:()=>async function(e){let{tokenAddress:t,chainId:n=c.VQ.id,walletAddress:a}=e;return t&&a?await(0,r.L)(i.g,{abi:I.Wo,address:t,functionName:"balanceOf",args:[a],chainId:n}):BigInt(0)}({tokenAddress:t,walletAddress:n,chainId:a}),enabled:o&&Boolean(t)&&Boolean(n)})},W=e=>{let{tokenAddress:t,walletAddress:n,formatOptions:a,chainId:o=c.VQ.id,enabled:r=!0}=e;const{data:s,isLoading:i}=(e=>{let{tokenAddress:t,chainId:n=c.VQ.id,enabled:a=!0}=e;return(0,k.useQuery)({queryKey:["tokenInfo",t,n],queryFn:()=>N({tokenAddress:t,chainId:n}),enabled:a&&!!t,staleTime:1/0})})({tokenAddress:t,chainId:o,enabled:r}),{data:l,isLoading:d,refetch:u}=x({walletAddress:n,tokenAddress:t,chainId:o,enabled:r});return{isLoading:i||d,data:s?{...s,balance:(0,T.eS)({wei:null!=l?l:BigInt(0),decimals:s.decimals,symbol:s.symbol,formatOptions:a})}:void 0,refetch:u}}},90650:function(e,t,n){n.d(t,{ol:function(){return i},o0:function(){return a.o},eS:function(){return s},An:function(){return a.A}});var a=n(74999),o=n(67330),r=n(49312);const s=e=>{const{decimals:t,symbol:n}=function(e){return void 0!==e.tokenName}(e)?o.f5[e.tokenName]:e;var s;const l=null!==(s=e.wei)&&void 0!==s?s:BigInt(0),c=(0,a.A)(l,t);return{wei:l,value:c,formatted:i((0,r.v_)(c),n,{...e.formatOptions})}};const i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{stableToDollar:a=!0,showPlusSign:o=!1}=n,r=a&&"usdt"===t.toLowerCase()?"$":t,s=((e,t)=>Number(e)>0&&t?"+":Number(e)<0?"-":"")(e,o),i=String(e).replace(/^[-+]/,"");return"$"===r?"".concat(s,"$").concat(i):"".concat(s).concat(i," ").concat(r)}},74999:function(e,t,n){n.d(t,{A:function(){return r},o:function(){return o}});var a=n(40207);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18;const n="number"==typeof e?new Intl.NumberFormat("en-US",{useGrouping:!1,maximumFractionDigits:t,roundingMode:"trunc"}).format(e):e.replace(new RegExp("(?<=\\.\\d{".concat(t,"})\\d+")),"");return a.parseUnits(n,t)},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18;return parseFloat(a.formatUnits(e,t))}},74499:function(e,t,n){n.d(t,{N:function(){return b}});var a=n(67330),o=n(39804),r=n(6843),s=n(67237),i=n(81395),l=n(91818),c=n(80461),d=n(12777),u=n(98692),f=n(47177),m=n.n(f);function h(e){let{children:t,size:n="md",variant:a="filled",minWidth:s,toastId:i,onClick:l,closeOnClick:c=!0,className:d,...f}=e;const h={sm:"text-[10px]",md:"text-xs",lg:"text-sm"}[n],p={outlined:"border border-[#005ab9]",ghost:"border-none bg-none text-primary-600",filled:""}[a];return(0,o.jsx)(u.default,{href:f.href,onClick:()=>{c&&r.toast.dismiss(i),null==l||l()},className:m()("flex items-center justify-center gap-2 rounded text-neutral-50","py-2 px-4 transition whitespace-nowrap font-semibold",{"bg-[#005ab9]":"filled"===a},h,p,d),...f,children:t})}function p(e){const t="Could not copy text";e&&console.debug("".concat(t,": "),e),r.toast.error("".concat(t,". Please do it manually"))}var g=n(61238);async function w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;var a,u;if(!e)return void r.toast.error("Invalid transaction");const f=(0,l.xz)(t),m=null==f||null===(u=f.blockExplorers)||void 0===u||null===(a=u.default)||void 0===a?void 0:a.url,w="".concat(m,"/tx/").concat(e);r.toast.info((t=>{let{toastProps:n}=t;return(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)("b",{children:"Transaction Hash:"}),(0,o.jsx)("i",{children:e}),(0,o.jsx)(d.Z,{closeOnClick:!1,toastId:n.toastId,className:"bg-primary-600 text-neutral-50",onClick:()=>{var t;(t=e)&&(navigator.clipboard?navigator.clipboard.writeText(t).then((()=>{r.toast.success("Copied to clipboard!",{toastId:"copyToClipboard"})}),(e=>{p(e)})):p("navigator.clipboard is not available"))},children:"Copy"}),m&&(0,o.jsx)(h,{href:w,rel:"noreferrer ",target:"_blank",variant:"ghost",closeOnClick:!1,toastId:n.toastId,className:"text-neutral-50 font-normal",children:"View on block explorer"})]})}),{autoClose:15e3,closeOnClick:!1});const b=Date.now();r.toast.loading("Waiting for transaction to finish...",{toastId:b});const v={type:r.toast.TYPE.ERROR,render:"Transaction failed: ".concat((0,c.Z)(e,{start:5,end:5})),autoClose:5e3,isLoading:!1};try{const a=await(0,s.e)(i.g,{hash:e,timeout:3e5,chainId:t,confirmations:n,onReplaced:e=>console.debug("onTxReplaced",{newTransaction:e})});return r.toast.update(b,{...v,...(null==a?void 0:a.status)?{type:r.toast.TYPE.SUCCESS,render:"Transaction finished: ".concat((0,c.Z)(e,{start:5,end:5}))}:{}}),a.linkToBlockExplorer=w,a}catch(e){const t=(0,g.S)(e),n=()=>(0,o.jsxs)("div",{className:"flex flex-col",children:["We haven't received a confirmation from the Blockchain about the completion of your transaction. Please use the following link to check its status:",m&&(0,o.jsx)(h,{href:w,rel:"noreferrer ",target:"_blank",variant:"ghost",closeOnClick:!1,toastId:b,className:"text-neutral-50 font-normal",children:"View transaction"})]}),a=t.message.includes("Timed out while waiting for transaction with hash"),s=a?n:t.message,i={...v,render:s,...a&&{type:r.toast.TYPE.WARNING}};r.toast.update(b,i)}}const b=async function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=await w(...t);if(![1,"success"].includes(null==o?void 0:o.status))throw new Error(a.dT.TRANSACTION_FAILED);return o}},91843:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(93889),o=n(33552),r=n(6843),s=n(67781),i=n(67330),l=n(62814);var c=n(6403);var d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EVM";const{session:t,query:n}=(0,c.kP)(),o=(0,a.useMemo)((()=>{var n,a;return null===(a=t.user)||void 0===a||null===(n=a.wallets)||void 0===n?void 0:n.find((t=>t.attributes.network===e))}),[t.user,e]),r=!!t.user;return{user:t.user,userWallet:o,isLoadingUser:n.isFetching,isAuthed:r}};var u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EVM";const{userWallet:t}=d();return{getUserWalletType:(0,a.useCallback)((()=>{if(!t)throw new Error("Please add ".concat(e," wallet to your Magic ID"));let n=s.Z.get(i.mJ.MSQ_CONNECTED_WALLET_TYPE);"Phantom"===n&&"SOLANA"!==e&&((0,l.Z)(),n=void 0);const a={WALLETCONNECT:"WalletConnect",WALLETCONNECT2:"WalletConnect2",PHANTOM:"Phantom",METAMASK:"EVM",EVM:"EVM"}[null==(c=n)?void 0:c.toUpperCase()];var c;if(o.isDesktop||"EVM"!==a||r.toast.info("EVM wallets is only available by WalletConnect on Mobile."),!o.isDesktop&&"Phantom"===a)throw new Error("Phantom wallet is not available on Mobile.");let d=o.isDesktop?a||t.attributes.wallet||"WalletConnect2":"WalletConnect";return"EVM"===d&&(d="WalletConnect2"),"WalletConnect2"===a&&(d=a),{walletType:d,userWallet:t}}),[t,e]),getUserWalletAddress:(0,a.useCallback)((()=>{if(!t)throw new Error("Please add ".concat(e," wallet to your Magic ID"));return{address:t.attributes.address,userWallet:t}}),[t,e])}}}}]);