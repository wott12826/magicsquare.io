"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7389],{8325:function(t,e,a){a.d(e,{X:function(){return S}});var s=a(78394),n=a(30121),r=a(67330),i=a(74499),d=a(34222),u=a(91843),o=a(6843),c=a(27183),l=a(15516),k=a(81395),m=a(61238),y=a(62814),g=a(97466),w=a(8411);const p=r.VQ;var f=a(79781),T=a(94619);const S=()=>{const t=(0,s.useQueryClient)(),{checkChainAndBalance:e}=(0,d.Z)(),{claimTokens:a}=function(){const{connectWallet:t}=(0,g.default)(),{getUserWalletType:e}=(0,u.Z)(),a=async s=>{const{stakingType:n,stakeId:i}=s,d=Date.now();try{const{walletType:t,userWallet:a}=e();if(!n.contractAddress)throw new Error("Contract address is not provided");const{request:s}=await(0,c.a)(k.g,{...r.zT,address:n.contractAddress,functionName:"claim",chainId:p.id,gas:BigInt(3e5),args:[i]});return await Promise.race([(0,l.n)(k.g,s),(0,w.Z)({walletType:t,address:a.attributes.address,toastId:d,hideRetryButton:!0,title:"Claiming..."})])}catch(n){const i=(0,m.S)(n),d=async()=>{const{walletType:n,userWallet:r}=e();return await t({walletType:n,targetAddress:r.attributes.address}),a(s)};if(i.message===r.dT.CONNECTOR_NOT_FOUND)return(0,y.Z)(),await d();if(i.message===r.dT.RETRY)return await a(s);throw n}finally{o.toast.dismiss(d)}};return{claimTokens:a}}(),{getUserWalletType:S}=(0,u.Z)(),{isSuccess:h}=(0,T.Z)();return(0,n.useMutation)({mutationFn:async t=>{let{stakeId:s,stakeType:n}=t;const{success:d}=await e({targetChain:r.VQ,shouldWaitWeb3Modal:!0});if(!d)return{success:d};const u=await a({stakeId:s,stakingType:n});return await(0,i.N)(u,r.VQ.id),{success:!0,result:u}},onSuccess:(e,a)=>{let{stakeId:s,stakeType:n}=a;if(!e.success)return;const{userWallet:r}=S();t.setQueryData((0,f.E)(h,r.attributes.address),(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((t=>t.stakeId!==s||t.stakingTypeId!==n.id?t:{...t,claimableAmount:0}))}))}})}},44972:function(t,e,a){a.d(e,{Y:function(){return q},u:function(){return Z}});var s=a(6843),n=a(78394),r=a(30121),i=a(82588),d=a(70233),u=a.n(d),o=a(69009),c=a(67330),l=a(74499),k=a(34222),m=a(91843),y=a(27183),g=a(15516),w=a(81395),p=a(61238),f=a(62814),T=a(81807),S=a(74999),h=a(97466),b=a(8411);const v=c.VQ;var A=a(79781),I=a(94619);const q="Not enough SQR",Z=()=>{const t=(0,n.useQueryClient)(),{checkChainAndBalance:e}=(0,k.Z)(),{getUserWalletType:a}=(0,m.Z)(),{stakeTokens:d}=function(){const{connectWallet:t}=(0,h.default)(),{getUserWalletType:e}=(0,m.Z)(),{approveIfNeeded:a}=(0,T.M3)(),n=async r=>{const{amount:i,stakingType:d}=r,u=Date.now();try{const{walletType:t,userWallet:s}=e();if(!d.contractAddress)throw new Error("Contract address is not provided");await a({chainId:v.id,amount:i,spenderAddress:d.contractAddress,tokenAddress:c.Yv.address,tokenDecimals:c.Yv.decimals});const{request:n}=await(0,y.a)(w.g,{...c.zT,address:d.contractAddress,functionName:"stake",chainId:v.id,gas:BigInt(3e5),args:[(0,S.o)(i,c.Yv.decimals).toBigInt()]});return await Promise.race([(0,g.n)(w.g,n),(0,b.Z)({walletType:t,address:s.attributes.address,toastId:u,hideRetryButton:!0,title:"Staking..."})])}catch(a){const s=(0,p.S)(a),i=async()=>{const{walletType:a,userWallet:s}=e();return await t({walletType:a,targetAddress:s.attributes.address}),n(r)};if(s.message===c.dT.CONNECTOR_NOT_FOUND)return(0,f.Z)(),await i();if(s.message===c.dT.RETRY)return await n(r);throw a}finally{s.toast.dismiss(u)}};return{stakeTokens:n}}(),{isSuccess:Z}=(0,I.Z)();return(0,r.useMutation)({mutationFn:async t=>{let{amount:n,stakeType:r}=t;const{success:i,details:u}=await e({targetChain:c.VQ,amount:n,token:c.Yv});if(!i){if(null==u?void 0:u.notEnoughSqrBalance)throw new Error(q);return{success:!1}}const k=await d({amount:n,stakingType:r});await(0,l.N)(k,c.VQ.id);const m=Date.now();s.toast.info("Waiting for staking confirmation...",{isLoading:!0,toastId:m,closeOnClick:!1});const{userWallet:y}=a(),g=await(0,o.FzB)({tx:k||"",smartContract:r.contractAddress||"",amount:n,wallet:y.attributes.address});return s.toast.dismiss(m),g.confirmed?s.toast.success("Staking confirmed"):s.toast.error("Failed to confirm staking. ".concat(g.error)),{success:!0,hash:k}},onSuccess:(e,s)=>{let{amount:n,stakeType:r}=s;const{userWallet:d}=a();t.setQueryData((0,A.E)(Z,d.attributes.address),(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Date,a=t.filter((t=>t.stakingTypeId===r.id)).reduce(((t,e)=>Math.max(t,e.stakeId)),-1);return[...t,{id:u()(),apr:r.apr,claimableAmount:0,claimedAmount:0,claimedAt:e.toISOString(),endDate:(0,i.Z)(e,r.lockPeriodInSeconds).toISOString(),lockPeriodInSeconds:r.lockPeriodInSeconds,stakedAmount:Number(n),stakeId:a+1,stakedAt:e.toISOString(),stakingTypeId:r.id,withdrawn:!1}]})),t.setQueriesData({queryKey:(0,I.F)(d.attributes.address)},(t=>t?t.map((t=>t.id!==r.id?t:{...t,userStaked:t.userStaked+Number(n)})):t))}})}},94173:function(t,e,a){var s=a(10308),n=a(69009),r=a(43519);e.Z=()=>{const{userEvmWallet:t}=(0,r.useAuth)();return(0,s.useQuery)({queryKey:["selfSqrLocked",null==t?void 0:t.attributes.address],queryFn:()=>(0,n.GbG)(),enabled:!!(null==t?void 0:t.attributes.address)})}},71287:function(t,e,a){var s=a(93889),n=a(90592),r=a(43519),i=a(67330);e.Z=()=>{const{user:t}=(0,r.useAuth)(),e=(0,s.useMemo)((()=>{var e;return null==t||null===(e=t.wallets)||void 0===e?void 0:e.find((t=>"EVM"===t.attributes.network))}),[t]);return(0,n.useBalance)({query:{enabled:!!e},address:null==e?void 0:e.attributes.address,token:i.Yv.address,chainId:i.VQ.id})}},23026:function(t,e,a){var s=a(93889),n=a(43519),r=a(79781);e.Z=()=>{const{userEvmWallet:t}=(0,n.useAuth)(),{data:e,isPending:a}=(0,r.Z)({walletAddress:null==t?void 0:t.attributes.address});return{isLoading:a,data:(0,s.useMemo)((()=>null==e?void 0:e.reduce(((t,e)=>e.withdrawn?t:t+e.stakedAmount),0)),[e])}}},75880:function(t,e,a){var s=a(10308),n=a(69009);e.Z=()=>(0,s.useQuery)({queryKey:["stakingDashboard"],queryFn:()=>(0,n.si)()})},66041:function(t,e,a){a.d(e,{g:function(){return o}});var s=a(10308),n=a(13898),r=a(81395),i=a(67330),d=a(74999),u=a(94619);const o=()=>{const{data:t,isSuccess:e}=(0,u.Z)();return(0,s.useQuery)({queryKey:["stakingStats",e],queryFn:()=>(async t=>{const e=(null==t?void 0:t.map((t=>t.contractAddress)).filter((t=>!!t)))||[],a=(await Promise.all(e.map((async t=>{const e={abi:i.zT.abi,address:t},[a,s]=await(0,n.A)(r.g,{chainId:i.VQ.id,contracts:[{...e,functionName:"totalStaked"},{...e,functionName:"getBalance"}]});var d,u;return{totalStaked:null!==(d=a.result)&&void 0!==d?d:0n,balance:null!==(u=s.result)&&void 0!==u?u:0n}})))).reduce(((t,e)=>({totalStaked:t.totalStaked+e.totalStaked,balance:t.balance+e.balance}))),s=(0,d.A)(a.balance,i.Yv.decimals);return{totalStaked:(0,d.A)(a.totalStaked,i.Yv.decimals),balance:s}})(t),enabled:e})}},94619:function(t,e,a){a.d(e,{F:function(){return l}});var s=a(10308),n=a(90241),r=a(58017),i=a(69009),d=a(67330),u=a(74999),o=a(71629);const c=async t=>{const e=await(0,i.je8)(),{uniqueStakingSettings:a}=e.data.reduce(((t,e)=>(e.attribute.smart_contract?e.attribute.smart_contract in t.uniqueContracts||(t.uniqueContracts[e.attribute.smart_contract]=!0,t.uniqueStakingSettings.push(e)):t.uniqueStakingSettings.push(e),t)),{uniqueContracts:{},uniqueStakingSettings:[]});return await Promise.all(a.map((async e=>e.attribute.enabled&&e.attribute.smart_contract&&(0,r.U)(e.attribute.smart_contract)?(async(t,e,a)=>{const{hidden:s=!1,enabled:n=!1,hot:r,apr_sqrp:i=0}=t.attribute,c=await(0,o._)(e,a);return{id:t.id,apr:c.apr,aprSqrp:10*i,contractAddress:e,maxStake:(0,u.A)(c.maxStakeAmount,d.Yv.decimals),minStake:(0,u.A)(c.minStakeAmount,d.Yv.decimals),lockPeriodInSeconds:c.duration,hidden:s,enabled:n,hot:r,index:t.attribute.index,totalStaked:(0,u.A)(c.totalStaked,d.Yv.decimals),limit:(0,u.A)(c.limit,d.Yv.decimals),userStaked:(0,u.A)(c.userStaked,d.Yv.decimals)}})(e,e.attribute.smart_contract,t):(t=>{const{apr:e,smart_contract:a,enabled:s=!1,hidden:r=!1,max_stake:i=0,min_stake:d=0,duration:u=0,apr_sqrp:o=0,hot:c,index:l}=t.attribute;return{id:t.id,apr:10*e,aprSqrp:10*o,contractAddress:a,enabled:!!a&&s,hidden:r,maxStake:i,minStake:d,lockPeriodInSeconds:u*n.gM,totalStaked:0,limit:0,userStaked:0,hot:c,index:l}})(e))))},l=t=>["stakingTypes",t||""];e.Z=t=>(0,s.useQuery)({queryKey:l(t),queryFn:()=>c(t),staleTime:1/0})},19753:function(t,e,a){a.d(e,{D:function(){return S}});var s=a(78394),n=a(30121),r=a(67330),i=a(74499),d=a(34222),u=a(91843),o=a(6843),c=a(27183),l=a(15516),k=a(81395),m=a(61238),y=a(62814),g=a(97466),w=a(8411);const p=r.VQ;var f=a(79781),T=a(94619);const S=()=>{const t=(0,s.useQueryClient)(),{checkChainAndBalance:e}=(0,d.Z)(),{unstakeTokens:a}=function(){const{connectWallet:t}=(0,g.default)(),{getUserWalletType:e}=(0,u.Z)(),a=async s=>{const{stakingType:n,stakeId:i}=s,d=Date.now();try{const{walletType:t,userWallet:a}=e();if(!n.contractAddress)throw new Error("Contract address is not provided");const{request:s}=await(0,c.a)(k.g,{...r.zT,address:n.contractAddress,functionName:"unstake",chainId:p.id,gas:BigInt(3e5),args:[i]});return await Promise.race([(0,l.n)(k.g,s),(0,w.Z)({walletType:t,address:a.attributes.address,toastId:d,hideRetryButton:!0,title:"Unstaking..."})])}catch(n){const i=(0,m.S)(n),d=async()=>{const{walletType:n,userWallet:r}=e();return await t({walletType:n,targetAddress:r.attributes.address}),a(s)};if(i.message===r.dT.CONNECTOR_NOT_FOUND)return(0,y.Z)(),await d();if(i.message===r.dT.RETRY)return await a(s);throw n}finally{o.toast.dismiss(d)}};return{unstakeTokens:a}}(),{getUserWalletType:S}=(0,u.Z)(),{isSuccess:h}=(0,T.Z)();return(0,n.useMutation)({mutationFn:async t=>{let{stakeId:s,stakeType:n}=t;const{success:d}=await e({targetChain:r.VQ,shouldWaitWeb3Modal:!0});if(!d)return{success:d};const u=await a({stakeId:s,stakingType:n});return await(0,i.N)(u,r.VQ.id),{success:!0,result:u}},onSuccess:(e,a)=>{let{stakeId:s,stakeType:n}=a;if(!e.success)return;const{userWallet:r}=S();t.setQueryData((0,f.E)(h,r.attributes.address),(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((t=>t.stakeId!==s||t.stakingTypeId!==n.id?t:{...t,withdrawn:!0}))}))}})}},79781:function(t,e,a){a.d(e,{E:function(){return i}});var s=a(10308),n=a(94619),r=a(71629);const i=(t,e)=>["userStakes",t,e];e.Z=t=>{let{walletAddress:e}=t;const{data:a,isSuccess:d}=(0,n.Z)();return(0,s.useQuery)({queryKey:i(d,e),queryFn:()=>(0,r.f)({walletAddress:e,stakingTypes:a||[]}),enabled:Boolean(e)&&d})}}}]);