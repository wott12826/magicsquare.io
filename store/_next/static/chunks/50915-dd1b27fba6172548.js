"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50915],{260294:function(e,s,t){t.d(s,{Z:function(){return y}});var n=t(939804),l=t(893889),a=t(185151),i=t(553321),r=t(869009),c=t(722522),m=t(375959),o=t(914721),d=t(360116),x=t(206843),u=t(147021),h=t.n(u),b=t(185984),q=t(818357),f=t(932382),p=t(210313),g=t(855863),j=t(249312),N=t(797485);const v=e=>{let{...s}=e;const{data:t,fetchNextPage:i,hasNextPage:r,isLoading:c,isFetchingNextPage:m}=(0,a.useInfiniteQuery)({...(0,q.cR)(),enabled:s.open}),{mutateAsync:o}=(0,q.F9)(),{mutateAsync:u}=(0,q.Pk)(),{ref:v}=(0,d.YD)({onChange:e=>e&&!c&&!m&&i()}),y=(0,l.useRef)([]),k=(0,l.useRef)(-1),w=(0,l.useMemo)((()=>null==t?void 0:t.pages.flatMap((e=>e.rows))),[t]),C=!(null==w?void 0:w.length)||!w.filter((e=>!e.removed)).length,D=!c&&!C,R=c||r,A=!r&&!c&&C,E="flex flex-col -my-0.5 [&>*>*]:my-0.5";return(0,n.jsx)(f.fC,{...s,children:(0,n.jsx)(f.h_,{children:(0,n.jsx)(f.aV,{forceMount:!0,className:"msq-dialog msq-dialog-animate msq-dialog-mobile-menu-m xl-msq:msq-dialog-mobile-menu-d",children:(0,n.jsxs)(f.VY,{forceMount:!0,"aria-describedby":void 0,className:"msq-dialog-content sm-msq:msq-dialog-content-sm sm-msq:msq-dialog-content-right xl-msq:max-w-[25rem]",children:[(0,n.jsxs)("div",{className:"msq-dialog-header",children:[(0,n.jsx)(f.Dx,{className:"msq-dialog-title",children:"Notifications"}),(0,n.jsx)(f.x8,{asChild:!0,children:(0,n.jsx)("button",{className:"msq-btn msq-btn-ghost msq-btn-icon-md msq-dialog-icon-button",children:(0,n.jsx)(p.s,{className:"msq-btn msq-btn-icon-child"})})})]}),(0,n.jsxs)("div",{className:"msq-dialog-body flex flex-col xl-msq:pt-5",children:[D&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 xl-msq:gap-6 mb-4 xl-msq:mb-5 xl-msq:px-2 text-base-text-tertiary text-caption-sm-m xl-msq:text-caption-sm-d  transition-colors",children:[(0,n.jsx)("button",{onClick:async()=>{try{await u({type:"all"})}catch(e){x.toast.error(b.T1.DEFAULT_RETRY)}},className:"hover:text-base-text-primary",children:"Mark All as Read"}),(0,n.jsx)("button",{onClick:async()=>{try{await o({type:"all"})}catch(e){x.toast.error(b.T1.DEFAULT_RETRY)}},className:"hover:text-base-text-primary",children:"Delete all"})]}),(0,n.jsx)("ul",{className:E,children:w.map((e=>{const s="READ"===e.status,t=!!e.removed;return(0,n.jsx)(d.df,{as:"li",onChange:n=>{const l=y.current.includes(e.id);var a;!n||s||t||l||(a=e.id,window.clearTimeout(k.current),y.current.push(a),k.current=window.setTimeout((()=>{const e=y.current;y.current=[],window.setTimeout((async()=>{try{await u({type:"ids",ids:e})}catch(e){x.toast.error(b.T1.DEFAULT_RETRY)}}),1e3)}),500))},className:(0,j.cn)("overflow-hidden",{"animate-remove-item":t}),children:(0,n.jsxs)("div",{className:(0,j.cn)("flex items-start gap-2 p-2 pb-3 xl-msq:p-3 w-full xl-msq:gap-3 rounded-lg transition-colors",s?"bg-transparent":"bg-right-side-panel-notification-unread"),children:[e.icon?(0,n.jsx)(N.Z,{width:24,height:24,className:"rounded size-6",src:e.icon,alt:e.icon||"Icon"}):(0,n.jsx)(g.Fh,{className:"icon size-6"}),(0,n.jsxs)("div",{className:"w-full",children:[e.title&&(0,n.jsxs)("div",{className:"mb-1 xl-msq:mb-2 flex flex-col gap-1 xl-msq:gap-2 pt-1 xl-msq:pt-0.5",children:[(0,n.jsx)("h3",{className:"text-caption-md-strong-m xl-msq:text-caption-md-strong-d",children:e.title}),(0,n.jsx)("p",{className:"text-base-text-secondary text-body-xs-m xl-msq:text-body-xs-d break-words inner-html msq-inner-html",dangerouslySetInnerHTML:{__html:h().sanitize(e.message)}})]}),!e.title&&(0,n.jsx)("p",{className:"my-0.5 text-base-text-secondary text-body-sm-m xl-msq:mt-0 xl-msq:mb-1 xl-msq:text-body-sm-d break-words inner-html",dangerouslySetInnerHTML:{__html:h().sanitize(e.message)}}),(0,n.jsxs)("div",{className:"flex gap-4 text-caption-xs-m xl-msq:text-caption-xs-d text-base-text-tertiary",children:[(0,n.jsx)("span",{className:"flex-1",children:(0,j.BK)(new Date(e.timestamp))}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{await o({type:"item",id:e})}catch(e){x.toast.error(b.T1.DEFAULT_RETRY)}})(e.id),className:"hover:text-base-text-primary",children:"Delete"})]})]})]})},e.id)}))})]}),A&&(0,n.jsx)("p",{className:"m-auto text-center text-base-text-quaternary text-caption-sm-m sm:text-caption-sm-d",children:"Nothing has happened here yet"}),R&&(0,n.jsxs)(n.Fragment,{children:[c&&(0,n.jsxs)("div",{className:"flex items-center gap-4 xl-msq:gap-6 mb-4 xl-msq:mb-5 xl-msq:px-2 text-caption-sm-m xl-msq:text-caption-sm-d",children:[(0,n.jsx)("span",{className:"msq-skeleton-text w-24"}),(0,n.jsx)("span",{className:"msq-skeleton-text w-[3.25rem]"})]}),(0,n.jsx)("ul",{ref:v,className:E,children:Array.from({length:10},((e,s)=>(0,n.jsx)("li",{children:(0,n.jsxs)("div",{className:"flex gap-2 p-2 pb-3 xl-msq:p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"msq-skeleton-block size-6 rounded flex-shrink-0"}),(0,n.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,n.jsxs)("div",{className:"mb-1 xl-msq:mb-2 flex flex-col gap-1 xl-msq:gap-2",children:[(0,n.jsx)("span",{className:"msq-skeleton-text text-caption-md-strong-m pt-1 xl-msq:pt-0.5 xl-msq:text-caption-md-strong-d"}),(0,n.jsx)("span",{className:"msq-skeleton-text h-12 text-body-xs-m xl-msq:text-body-xs-d"})]}),(0,n.jsxs)("div",{className:"flex justify-between text-caption-xs-m xl-msq:text-caption-xs-d",children:[(0,n.jsx)("span",{className:"msq-skeleton-text w-16"}),(0,n.jsx)("span",{className:"msq-skeleton-text w-9"})]})]})]})},s)))},null==t?void 0:t.pages.length)]})]})]})})})})};var y=()=>{const{socket:e}=(0,c.sV)(),{user:s}=(0,o.j)(),[t,d]=(0,l.useState)(!1),{data:x,refetch:u}=(0,a.useInfiniteQuery)({...(0,i.cRu)(),select:e=>e.pages.some((e=>e.rows.some((e=>e.status===r.foj.NEW)))),enabled:!!(null==s?void 0:s.data.id)});return(0,l.useEffect)((()=>{if(e)return e.on("notifications.update",(()=>{u()})),()=>{e.off("notifications.update")}}),[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>d(!0),className:"msq-btn msq-btn-icon-md msq-btn-ghost size-[2.25rem] text-base-text-primary md-msq:msq-btn-icon-lg",children:[(0,n.jsx)(m.e,{className:"msq-btn-icon-child-md"}),x&&(0,n.jsx)("span",{className:"size-2.5 md-msq:size-3 border-2 border-base-bg rounded-full bg-palette-pink-52 absolute top-0 right-0"})]}),(0,n.jsx)(v,{open:t,onOpenChange:d})]})}},207002:function(e,s,t){t.d(s,{U:function(){return d}});var n=t(939804),l=t(383737),a=t(347177),i=t.n(a),r=t(189919),c=t(12308),m=t(249312),o=t(350511);const d=e=>{let{items:s,onLogin:t,className:a,isConnected:d}=e;const x=(0,l.usePathname)();return(0,n.jsx)(r.fC,{className:(0,m.cn)("max-3xl-msq:hidden z-10",a),children:(0,n.jsx)(r.aV,{className:"flex",children:null==s?void 0:s.map((e=>{let{id:s,label:l,target:a,isHidden:u,href:h,external:b,isAuthRequired:q,children:f}=e;if(u)return null;const p=!1,g=f?!!f.find((e=>e.href===x)):h===x,j=i()("msq-btn msq-btn-lg px-3 hover:bg-transparent msq-btn-ghost",{"text-base-text-tertiary hover:text-base-text-pink":!g,"text-base-text-primary cursor-default":g,"msq-btn-ghost-disabled":p}),N=q&&!d;return f?(0,n.jsxs)(r.ck,{children:[(0,n.jsxs)(r.xz,{onClick:e=>{N&&(e.preventDefault(),null==t||t())},className:(0,m.cn)(j,"group"),children:[l,(0,n.jsx)(c.K,{className:"msq-btn-icon-child ml-1 group-data-[state=open]:rotate-180 transition-transform"})]},s),(0,n.jsx)(r.VY,{className:(0,m.cn)("msq-sub-menu absolute top-full min-w-[13.5rem] duration-150","data-[state=open]:animate-show-menu","data-[state=closed]:animate-hide-menu"),children:(0,n.jsx)("ul",{children:f.map((e=>{if(e.isHidden)return null;const s=x===e.href,l=e.isAuthRequired&&!d;return(0,n.jsx)("li",{children:(0,n.jsx)(r.rU,{asChild:!0,children:(0,n.jsx)(o.Z,{onClick:e=>{l&&(e.preventDefault(),null==t||t())},isAuthRequired:e.isAuthRequired,external:e.external,href:e.href,className:(0,m.cn)("msq-sub-menu-link msq-sub-menu-link-desktop",{"msq-sub-menu-link-active":s,"msq-sub-menu-link-disabled":!1}),children:e.label})})},e.id)}))})})]},s):(0,n.jsx)(o.Z,{target:a,href:h,external:b,isAuthRequired:q,onClick:e=>{N&&(e.preventDefault(),null==t||t())},className:i()(j),children:l},s)}))})})}},298313:function(e,s,t){t.d(s,{v:function(){return q}});var n=t(939804),l=t(383737),a=t(893889),i=t(882834),r=t(347177),c=t.n(r),m=t(932382),o=t(687622),d=t(785172),x=t(210313),u=t(967829),h=t(249312),b=t(350511);const q=e=>{let{items:s,className:t,title:r="Magic Square",isConnected:q,onLogin:f,...p}=e;var g,j;const N=(0,l.usePathname)(),[v,y]=(0,a.useState)(),k={timeout:300,mountOnEnter:!0,unmountOnExit:!0,preEnter:!0},[w,C]=(0,i.Y)({...k,initialEntered:!0}),[D,R]=(0,i.Y)(k),A=()=>{C(),R()},E=null==s?void 0:s.find((e=>{let{id:s}=e;return s===v})),[T,M]=(0,a.useState)(!1);(0,a.useEffect)((()=>{y(void 0),M(!1)}),[N]);const _="flex flex-col gap-1 p-2 overflow-auto",z=c()("transition-all duration-300 left-0 top-0 w-full ease-out",{absolute:"entering"===w.status||"exiting"===w.status,"opacity-0 -translate-x-2":"preEnter"===w.status||"exiting"===w.status}),F=c()("transition-all duration-300 left-0 top-0 w-full ease-out",{absolute:"entering"===D.status||"exiting"===D.status,"opacity-0 translate-x-2":"preEnter"===D.status||"exiting"===D.status}),Y=e=>{let{isActive:s,isDisabled:t}=e;return(0,h.cn)("msq-sub-menu-link msq-sub-menu-link-mobile w-full",{"msq-sub-menu-link-active":!t&&s,"msq-sub-menu-link-disabled":t})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>M(!0),className:(0,h.cn)("msq-btn msq-btn-icon-md msq-btn-outline size-[2.25rem] !rounded-full md-msq:msq-btn-icon-lg",t),children:(0,n.jsx)(u.v,{className:"msq-btn-icon-child-md"})}),(0,n.jsx)(m.fC,{open:T,onOpenChange:M,...p,children:(0,n.jsx)(m.h_,{children:(0,n.jsx)(m.aV,{forceMount:!0,className:"msq-dialog msq-dialog-mobile-menu-m msq-dialog-animate",children:(0,n.jsxs)(m.VY,{forceMount:!0,"aria-describedby":void 0,className:(0,h.cn)("msq-dialog-content sm-msq:msq-dialog-content-sm sm-msq:msq-dialog-content-left"),children:[(0,n.jsxs)("div",{className:"msq-dialog-header overflow-hidden",children:[(0,n.jsxs)("div",{className:"w-full relative",children:[w.isMounted&&(0,n.jsx)("div",{className:(0,h.cn)(z,"flex"),children:(0,n.jsx)(m.Dx,{className:"msq-dialog-title",children:r})}),D.isMounted&&(0,n.jsxs)("div",{className:(0,h.cn)(F,"flex"),children:[(0,n.jsx)("button",{onClick:()=>{A()},className:"msq-btn msq-btn-ghost msq-btn-icon-md msq-dialog-icon-button",children:(0,n.jsx)(o.x,{className:"msq-btn-icon-child"})}),(0,n.jsx)(m.Dx,{className:"msq-dialog-title w-full",children:null==E?void 0:E.label})]})]}),(0,n.jsx)(m.x8,{asChild:!0,children:(0,n.jsx)("button",{className:"msq-btn msq-btn-ghost msq-btn-icon-md msq-dialog-icon-button",children:(0,n.jsx)(x.s,{className:"msq-btn msq-btn-icon-child"})})})]}),(0,n.jsxs)("div",{className:"msq-dialog-body p-0 flex flex-col relative overflow-x-hidden",children:[w.isMounted&&(0,n.jsx)("div",{className:c()(z,"overflow-hidden flex flex-col"),children:(0,n.jsx)("ul",{className:(0,h.cn)(_),children:null==s?void 0:s.map((e=>{if(e.isHidden)return null;const s=e.isAuthRequired&&!q,t=!1,l=e.children?!!e.children.find((e=>e.href===N)):e.href===N;return(0,n.jsxs)("li",{children:[e.children&&(0,n.jsxs)("button",{onClick:()=>{s?(null==f||f(),M(!1)):(y(e.id),A())},className:Y({isDisabled:t,isActive:l}),children:[e.label,(0,n.jsx)(d.o,{className:"ml-auto size-4"})]}),!e.children&&(0,n.jsx)(b.Z,{href:e.href,onClick:e=>{s&&(null==f||f(),e.preventDefault()),M(!1)},className:Y({isDisabled:t,isActive:l}),children:e.label})]},e.id)}))})}),D.isMounted&&(0,n.jsx)("div",{className:c()(F),children:!!(null==E||null===(g=E.children)||void 0===g?void 0:g.length)&&(0,n.jsx)("ul",{className:_,children:null===(j=E.children)||void 0===j?void 0:j.map((e=>{let{id:s,label:t,isAuthRequired:l,href:a,isHidden:i}=e;if(i)return null;const r=l&&!q,c=a===N;return(0,n.jsx)("li",{children:(0,n.jsx)(b.Z,{onClick:e=>{r&&(null==f||f(),e.preventDefault()),M(!1)},href:a,className:Y({isDisabled:!1,isActive:c}),children:t})},s)}))})})]})]})})})})]})}}}]);
//# sourceMappingURL=50915-dd1b27fba6172548.js.map