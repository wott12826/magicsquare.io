"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98590],{992351:function(e,t,s){s.d(t,{a:function(){return l},d:function(){return o}});var n=s(939804),r=s(347177),a=s.n(r),i=s(239032);const o="reward-pool-requirements",l=e=>{let{children:t,isEmpty:s,query:r,hasBorders:l=!0,...c}=e;return(0,n.jsxs)("ul",{className:a()("flex flex-col",l&&"border-t border-b border-base-border-medium"),style:{scrollMarginTop:"250px"},"data-qa":"requirements_list",id:o,...c,children:[t,(0,n.jsx)(i.Z,{isEmpty:s,query:r,loading:(0,n.jsx)("div",{className:"flex flex-col gap-6 py-6",children:Array.from({length:4},((e,t)=>(0,n.jsx)("div",{className:"skeleton-block h-10 lg:h-11"},t)))})})]})}},199940:function(e,t,s){s.d(t,{n:function(){return o}});var n=s(939804),r=s(347177),a=s.n(r),i=s(715734);const o=e=>{let{isLoading:t,locked:s=!1,variant:r="primary",className:o,...l}=e;return(0,n.jsx)("button",{disabled:s,className:a()("msq-btn msq-btn-".concat(s?"secondary":r," msq-btn-md max-sm:w-full"),t&&"msq-btn-loading",o),...l,children:s?(0,n.jsx)(i.H,{className:"icon-xs"}):l.children})}},423604:function(e,t,s){s.d(t,{r:function(){return ie}});var n=s(939804),r=s(97516),a=s(796771),i=s(898845),o=s(893889),l=s(853840),c=s(943519),d=s(834167),u=s(199940),x=s(11793),m=s(735734),h=s(347177),p=s.n(h),f=s(908074),b=s(553321),y=s(661238),g=s(537806),j=s(775368),w=s(249312),v=s(646128);const k={[r.xp.SQR]:"SQR",[r.xp.SQRp]:"SQRp",[r.xp.USDT]:"USDT",[r.xp.FREE]:"Credits"},q=e=>{let{currency:t}=e;return(0,n.jsx)(v.k,{variant:v.v.DANGER,message:"Once confirmed, the ".concat(k[t]," will be deducted from your Magic ID balance and cannot be canceled.")})};var N=s(490650),A=s(536494);const _=e=>{let{currencyType:t,ticketsAmount:s}=e;const{price:a,currency:i}=t,o=i===r.xp.FREE?[{description:"You will use",value:"".concat(s*a," Raffle Credit")}]:[{description:"Ticket price",value:"".concat((0,N.ol)((0,w.v_)(a),i,{stableToDollar:!1}))},{description:"Total",value:(0,N.ol)((0,w.v_)(s*a),i,{stableToDollar:!1})}];return(0,n.jsx)(A.Y,{items:o})},S={[r.xp.SQR]:"sqr",[r.xp.SQRp]:"sqrp",[r.xp.FREE]:"raffleTickets",[r.xp.USDT]:"usdt"},T=[r.xp.SQR,r.xp.USDT],R=e=>{let{className:t,currencyType:s,onSubmit:i,rewardPool:l}=e;const{user:u}=(0,c.useAuth)(),{data:h}=(0,b.KP3)(null==u?void 0:u.id,{enabled:Boolean(null==u?void 0:u.id)}),{data:v=[]}=(0,d.CU)(l.id),{mutateAsync:k}=(0,a.cS)({rewardPool:l}),{currency:N,price:A}=s,R=S[N],P=R&&h&&h[R]?h[R]:0,F=(0,a.Xd)({balance:P,price:A,entryAmount:v.length,rewardPool:l}),L=(0,o.useMemo)((()=>f.z.object({amount:f.z.string().min(1,{message:"Field is required."}).transform((e=>parseInt(e,10))).refine((e=>e*A<=P),{message:"Insufficient balance."}).transform((e=>e.toString()))})),[A,P]),[E]=(0,o.useState)((()=>({amount:""}))),C=(0,m.cI)({resolver:(0,g.F)(L),defaultValues:E}),{handleSubmit:B,control:D,formState:U,reset:I,watch:Q,trigger:M}=C,O=Q("amount"),[W,V]=(0,o.useState)(!1);(0,o.useEffect)((()=>{const e=(e=>{let{currencyType:t,value:s,balance:n}=e;return(0,a.nY)({price:t.price,balance:n,entryAmount:s})&&T.some((e=>t.currency===e))})({currencyType:s,balance:P,value:O});O&&M("amount"),V(e)}),[O]);const Y=B((async e=>{try{await k({currencyType:s,entryAmount:Number(e.amount)}),I(E),i()}catch(e){(0,y.Z)({error:e})}})),{isDirty:G,errors:H,isSubmitting:z}=U,Z=Object.keys(H).length>0,K=!G||Z||z,[$,J]=(0,o.useState)("");return(0,n.jsxs)("form",{onSubmit:Y,className:p()("flex flex-col",t),children:[(0,n.jsx)(j.w,{name:"amount",label:"Select Number of Tickets",control:D,min:1,max:F,onChangeValue:J,renderHintMessage:e=>((e,t,s)=>{const a=e===r.xp.FREE?"Raffle Credits Balance: ".concat(t):"Magic ID ".concat(e," Balance: ").concat((0,w.v_)(t));return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:a}),Boolean(s)&&(0,n.jsx)("div",{children:s})]})})(N,P,e),presets:{show:N!==r.xp.FREE},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_,{currencyType:s,ticketsAmount:Number($)}),(0,n.jsx)(q,{currency:N})]})}),(0,n.jsxs)(x.C_,{children:[(0,n.jsx)(x.PO,{}),W?(0,n.jsxs)(x.Qd,{href:"/profile/membership/dashboard",target:"_blank",children:["Deposit ",s.currency]}):(0,n.jsx)(x.Qd,{type:"submit",isDisabled:K,children:"Confirm"})]})]})},P=e=>{let{currencyType:t,rewardPool:s,closeModal:r,...a}=e;return(0,n.jsx)(x.QA,{...a,title:"Get Tickets",titleIsLeftAligned:!0,size:"sm",children:(0,n.jsx)(R,{rewardPool:s,currencyType:t,onSubmit:()=>{r()}})})},F=e=>{let{currencyType:t,rewardPool:s,dataQaAttribute:r,...i}=e;const[x,m]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),{data:f=[]}=(0,d.CU)(s.id),{isAuth:b}=(0,c.useAuth)(),y=(0,a.OX)(s,f.length),g=!(0,a.Wr)(s)||y;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{open:x,onOpenChange:m,currencyType:t,rewardPool:s,closeModal:()=>{m(!1)}}),(0,n.jsx)(l.h,{isOpen:h,setIsOpen:p}),(0,n.jsx)(u.n,{...i,"data-qa":r,onClick:()=>{b?m(!0):p(!0)},disabled:g})]})};var L=s(353937),E=s(992351),C=s(745980);const B=e=>{let{label:t,description:s,buttons:r,counter:a,isLoading:i=!1,isDisabled:o=!1,...l}=e;return(0,n.jsx)("li",{className:p()("md:min-h-[4.5rem] border-b border-base-border-medium last:border-b-0"),...l,children:(0,n.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,n.jsxs)("div",{className:"flex w-full md:items-center py-5 gap-4 xl:gap-3 max-md:flex-col",children:[(0,n.jsxs)("p",{className:p()("flex flex-col gap-1 xl:gap-0.5",i&&"msq-skeleton-text h-4 w-[160px]"),children:[(0,n.jsx)("span",{className:p()("text-sm font-semibold xl:text-base text-base-text-primary",o&&"text-base-text-quaternary"),children:t}),s&&(0,n.jsx)("span",{className:p()("text-2xs leading-3 xl:text-xs font-medium text-base-text-tertiary"),children:s})]}),(0,n.jsx)("div",{className:p()("flex gap-3 [&>*]:w-full md:[&>*]:w-[10rem] md:ml-auto max-sm:flex-col",i&&"msq-skeleton-block h-8 w-[160px] max-md-msq:w-full"),children:r})]}),"number"==typeof a&&(0,n.jsx)(C.Af,{variant:a>0?C.u1.GREEN:C.u1.DEFAULT,text:a>0?String(a):"+1",size:C.TK.LARGE,className:"w-12"})]})})};var D=s(242898),U=s(183941);const I=()=>(0,n.jsxs)("p",{className:"text-base-text-secondary body-md-adaptive",children:["If you encounter any issues with the Pool, kindly visit our"," ",(0,n.jsx)(D.dL,{className:"text-base-text-pink",href:U.Vs,children:"Discord"})," ","and open a Support Ticket for assistance."]}),Q=e=>{let{header:t,showFooter:s,children:r}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-6 xl:gap-8",children:[t||null,r,s&&(0,n.jsx)(I,{})]})},M=e=>{let{rewardPool:t,showFooter:s=!0,showHeader:o=!0,hasBorders:l=!0}=e;const{requirements:c,hasRequirements:d,query:u}=(0,i.$)(t),x=t.status===r.iS.COMPLETED,{entriesAmountByCurrency:m}=(0,a.Zh)({poolId:t.id});return(0,n.jsx)(Q,{showFooter:s,header:o&&(0,n.jsx)("h2",{className:"heading-h2-adaptive",children:"Raffle Entry Options"}),children:(0,n.jsx)(E.a,{isEmpty:!d,query:u,hasBorders:l,"data-qa":"requirements_list",children:c.map((e=>{let{id:s,currencyType:r,title:a,description:i,action:o}=e;const l=(null==r?void 0:r.currency)?m[r.currency]:0;return(0,n.jsx)(B,{"data-qa":"requirement-id_".concat(s),isDisabled:x,label:a,description:i,buttons:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.B,{rewardPool:t,currency:null==r?void 0:r.currency,invisible:!l,dataQaAttribute:"view-my-tickets-button",children:"View Tickets"}),!x&&r&&(0,n.jsx)(F,{rewardPool:t,currencyType:r,dataQaAttribute:"get-ticket-for-".concat(r.currency),children:l>0?"Get More":null==o?void 0:o.label})]}),counter:l},s)}))})})};var O=s(827299),W=s(933377),V=s(891818);const Y=(e,t)=>{let{swap_token:s,swap_chain:n}=e;return s&&n?t?"".concat(t.symbol," on ").concat((0,V.fN)(n)," Chain"):"Unknown":"Any Token"};var G=s(206843),H=s(9910),z=s(47303),Z=s(94095);const K=e=>{let{rewardPool:t,locked:s,isLoading:r}=e;const{mutateAsync:i,isPending:o}=(0,a.BC)(t.id),{isJoined:l,isLoading:c}=(0,a.Fu)({rewardPool:t});return(0,n.jsx)(u.n,{onClick:async()=>{try{l||await i({rewardPool:t}),(0,z.Y)(H.Zt.swap("/"))}catch(e){const t=(0,Z.e)(e);G.toast.error(t)}},locked:s,isLoading:r||o||c,children:"Magic Swap"})},$={[r.Rp.ALL]:"Sell and Buy",[r.Rp.BUY]:"Buy",[r.Rp.SELL]:"Sell"},J={[r.Rp.ALL]:"Selling and Buying",[r.Rp.BUY]:"Buying",[r.Rp.SELL]:"Selling"};var X=s(481807);const ee=e=>{var t,s,n,r,a;const{data:i,isLoading:o}=(0,X.wp)({tokenAddress:null===(t=e.distribution_settings)||void 0===t?void 0:t.swap_token,chainId:null!==(a=Number(null===(s=e.distribution_settings)||void 0===s?void 0:s.swap_chain))&&void 0!==a?a:0,enabled:!!(null===(n=e.distribution_settings)||void 0===n?void 0:n.swap_token)&&!!(null===(r=e.distribution_settings)||void 0===r?void 0:r.swap_chain)});return{tokenInfo:i,isTokenLoading:o}},te={[r.Us.PRO_RATA_SWAP]:e=>{let{rewardPool:t,locked:s}=e;const{tokenInfo:r,isTokenLoading:a}=ee(t),i=((e,t)=>{if(!e.distribution_settings)return"";const{swap_type:s}=e.distribution_settings,n=$[s],r=Y(e.distribution_settings,t);return"".concat(n," ").concat(r," Using Swap")})(t,r);return(0,n.jsx)(B,{isLoading:a,"data-qa":"swap_action_".concat(t.id),isDisabled:s,label:i,description:"The higher the swap volume, the greater your reward.",buttons:(0,n.jsx)(K,{rewardPool:t,locked:s,isLoading:a})},t.id)},[r.Us.PRO_RATA_KARMA]:null,[r.Us.FCFS]:null,[r.Us.FCFS_V2]:null,[r.Us.RAFFLE]:null,[r.Us.RAFFLE_V2]:null,[r.Us.RAFFLE_SWAP]:e=>{let{rewardPool:t,locked:s}=e;const{tokenInfo:r,isTokenLoading:i}=ee(t),o=((e,t)=>{if(!e.distribution_settings)return"";const{distribution_settings:s}=e,n=J[s.swap_type],r=Y(s,t);return"Get Raffle Tickets When ".concat(n," ").concat(r," Using Swap")})(t,r),{data:l=[]}=(0,d.CU)(t.id),{distribution_settings:c}=t;if(!c)return null;const{swap_entry_price:u}=c;return(0,n.jsx)(B,{isLoading:i,"data-qa":"swap_action_".concat(t.id),isDisabled:s,label:o,description:"You will receive 1 ticket for every $".concat(u," of swap volume, increasing your chances to win!"),counter:l.length,buttons:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.BI,{invisible:0===l.length,dataQaAttribute:"view-my-tickets-button",rewardPool:t,children:"View Tickets"}),(0,n.jsx)(K,{rewardPool:t,locked:s,isLoading:i})]})},t.id)}},se=e=>{let{rewardPool:t,locked:s}=e;const r=te[t.distribution_policy];return r?(0,n.jsx)(r,{rewardPool:t,locked:s}):r};var ne=s(7045);const re=e=>{let{requirement:t,refetch:s}=e;const{isAuth:r}=(0,c.useAuth)(),[a,i]=(0,o.useState)(!1),[d,x]=(0,o.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[t.qualified?(0,n.jsx)(u.n,{variant:"secondary",disabled:!0,"data-qa":"verify-button",children:(0,n.jsx)(W.A,{className:"w-4 h-4 text-base-text-green"})}):(0,n.jsx)(u.n,{disabled:d,onClick:(m=t.id,async()=>{if(x(!0),!r)return void i(!0);const{data:e=[]}=await s(),t=(0,ne.l)(e).find((e=>e.id===m));(null==t?void 0:t.qualified)||G.toast.error("This task cannot be verified. Please make sure you have completed the task correctly and try again."),x(!1)}),isLoading:d,"data-qa":"verify-button",children:"Verify"}),(0,n.jsx)(l.h,{isOpen:a,setIsOpen:i,onClose:async()=>{x(!1),i(!1)}})]});var m},ae=e=>{let{rewardPool:t,showHeader:s=!0,showFooter:r=!0,hasBorders:a=!0}=e;const{requirements:l,hasRequirements:d,qualifiedRequirementsCount:x,qualifiedAllRequirements:m,qualifiedEnoughRequirements:h,query:f}=(0,i.$)(t),{refetch:b}=f,{isAuth:y}=(0,c.useAuth)();return(0,o.useEffect)((()=>{b()}),[y]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Q,{header:s&&(0,n.jsxs)("div",{className:"flex xl:justify-between max-xl:flex-col gap-4 xl:gap-6",children:[(0,n.jsx)("h2",{className:"heading-h2-adaptive",children:"Pool Requirements"}),(0,n.jsxs)("span",{className:"chip chip-lg min-h-10 font-semibold max-md:w-full md:max-w-[22.5rem] xl:max-w-none",children:[(0,n.jsx)(W.A,{className:p()("chip-icon",{"text-base-text-green":m,"text-base-text-quaternary":!m})}),x," / ",l.length," Requirements met"]})]}),showFooter:r,children:(0,n.jsx)(E.a,{isEmpty:!d,query:f,hasBorders:a,"data-qa":"requirements_list",children:(0,n.jsxs)(n.Fragment,{children:[l.map(((e,t)=>(0,n.jsx)(B,{"data-qa":"requirement-id_".concat(e.id),isDisabled:e.qualified,label:e.title,description:e.description,buttons:(0,n.jsxs)(n.Fragment,{children:[e.action&&!e.qualified&&(0,n.jsx)(u.n,{variant:"secondary",children:(0,n.jsx)(O.d,{href:e.action.href,className:"w-full",children:e.action.label})}),(0,n.jsx)(re,{requirement:e,refetch:b})]})},t))),(0,n.jsx)(se,{rewardPool:t,locked:!h})]})})})})},ie=e=>{let{rewardPool:t,hasBorders:s,showHeader:a,showFooter:i}=e;const o=t.distribution_policy===r.Us.RAFFLE_V2?M:ae;return(0,n.jsx)(o,{rewardPool:t,showHeader:a,showFooter:i,hasBorders:s})}},802314:function(e,t,s){s.d(t,{d:function(){return o}});var n=s(939804),r=s(347177),a=s.n(r),i=s(912919);const o=e=>{let{tickets:t,className:s,title:r,showWinText:o=!0,extraBottom:l}=e;const c=t.map((e=>(0,n.jsx)(i.k,{code:e.code,isWinner:e.isWinner,showWinText:o,extraBottom:l},e.code)));return(0,n.jsxs)("div",{className:a()("flex flex-col gap-1.5",s),children:[r?(0,n.jsx)("div",{className:"text-caption-sm-strong-a text-base-text-primary",children:r}):null,(0,n.jsx)("div",{className:a()("flex flex-col"),children:c})]})}},912919:function(e,t,s){s.d(t,{k:function(){return i}});var n=s(939804),r=s(796771),a=s(126118);const i=e=>{let{code:t,isWinner:s,showWinText:i=!0,extraBottom:o}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between gap-2 group items-center",children:[(0,n.jsxs)("div",{className:"h-10 flex items-center gap-2 max-w-full overflow-hidden",children:[(0,n.jsx)(r.DW,{code:t,isWinner:s}),s&&i&&(0,n.jsx)("span",{className:"text-base-text-orange text-caption-sm-a",children:"Win!"})]}),(0,n.jsx)(a.q,{value:t,className:" p-2 max-sm-msq:opacity-100 opacity-0 group-hover:opacity-100 transition-opacity msq-btn msq-btn-icon-md msq-btn-md msq-btn-ghost h-8 "})]}),o]})}},952821:function(e,t,s){s.d(t,{x:function(){return a}});var n=s(939804),r=s(208036);const a=e=>{let{title:t}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-1.5",children:[t?(0,n.jsx)("div",{className:"text-caption-sm-strong-a text-base-text-primary",children:t}):"",(0,n.jsxs)("div",{className:"flex gap-2 items-center py-2",children:[(0,n.jsx)(r.S,{className:"text-base-text-quaternary icon-xs"}),(0,n.jsx)("div",{className:"skeleton-text h-3 w-[80px]"})]})]})}},353937:function(e,t,s){s.d(t,{B:function(){return m}});var n=s(939804),r=s(893889),a=s(347177),i=s.n(a),o=s(199940),l=s(834167),c=s(796771),d=s(11793),u=s(802314);const x=e=>{let{rewardPool:t,closeModal:s,currency:a,...i}=e;const{data:o=[],isLoading:x}=(0,l.CU)(t.id),m=(0,r.useMemo)((()=>(a?o.filter((e=>e.currency===a)):o).map((e=>({isWinner:Boolean(e.reward),code:e.id})))),[o,a]);return(0,n.jsx)(d.QA,{...i,title:"My Tickets in ".concat(t.name),titleIsLeftAligned:!0,noSidePadding:!0,size:"md",footer:(0,n.jsx)(d.PO,{className:"!w-[220px] max-sm",children:"Close"}),children:x?(0,n.jsx)(c.xJ,{}):(0,n.jsx)("div",{className:"h-[500px] max-h-[55vh]",children:(0,n.jsx)(u.d,{className:"py-6 px-4",tickets:m,isLoading:x})})})},m=e=>{let{rewardPool:t,dataQaAttribute:s,currency:a,invisible:l=!1,...c}=e;const[d,u]=(0,r.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)(x,{open:d,onOpenChange:u,rewardPool:t,closeModal:()=>{u(!1)},currency:a}),(0,n.jsx)(o.n,{...c,className:i()({invisible:l}),variant:"secondary","data-qa":s,onClick:()=>{u(!0)}})]})}},873350:function(e,t,s){s.d(t,{D:function(){return l}});var n=s(939804),r=s(347177),a=s.n(r),i=s(980461),o=s(208036);const l=e=>{let{code:t,isWinner:s}=e;return(0,n.jsxs)("div",{className:"flex gap-1.5 items-center",children:[(0,n.jsx)(o.S,{className:a()("w-4 h-4 flex-shrink-0 text-caption-sm-mono-a",s?"text-base-text-orange":"text-base-text-quaternary")}),(0,n.jsx)("span",{className:"text-base-text-primary text-caption-sm-a truncate",children:(0,i.Z)(t,{start:4,end:4})})]})}}}]);
//# sourceMappingURL=98590-b777de3172aceeaf.js.map