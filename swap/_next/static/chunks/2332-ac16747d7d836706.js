"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2332],{2332:function(e,t,n){n.d(t,{kL:function(){return v},hj:function(){return A},FM:function(){return N},U4:function(){return P},eN:function(){return F},y9:function(){return h},Hu:function(){return I}});var i=n(57627),r=n(70159),a=n.n(r),s=JSON.parse('[{"inputs":[{"internalType":"contract IWETH","name":"_weth","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"AdvanceEpochFailed","type":"error"},{"inputs":[],"name":"ArbitraryStaticCallFailed","type":"error"},{"inputs":[],"name":"BadSignature","type":"error"},{"inputs":[],"name":"BitInvalidatedOrder","type":"error"},{"inputs":[],"name":"ETHTransferFailed","type":"error"},{"inputs":[],"name":"EpochManagerAndBitInvalidatorsAreIncompatible","type":"error"},{"inputs":[],"name":"EthDepositRejected","type":"error"},{"inputs":[],"name":"InvalidMsgValue","type":"error"},{"inputs":[],"name":"InvalidPermit2Transfer","type":"error"},{"inputs":[],"name":"InvalidShortString","type":"error"},{"inputs":[],"name":"InvalidatedOrder","type":"error"},{"inputs":[],"name":"MakingAmountTooLow","type":"error"},{"inputs":[],"name":"MismatchArraysLengths","type":"error"},{"inputs":[],"name":"OrderExpired","type":"error"},{"inputs":[],"name":"OrderIsNotSuitableForMassInvalidation","type":"error"},{"inputs":[],"name":"PartialFillNotAllowed","type":"error"},{"inputs":[],"name":"Permit2TransferAmountTooHigh","type":"error"},{"inputs":[],"name":"PredicateIsNotTrue","type":"error"},{"inputs":[],"name":"PrivateOrder","type":"error"},{"inputs":[],"name":"ReentrancyDetected","type":"error"},{"inputs":[],"name":"RemainingInvalidatedOrder","type":"error"},{"inputs":[],"name":"SafeTransferFailed","type":"error"},{"inputs":[],"name":"SafeTransferFromFailed","type":"error"},{"inputs":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"res","type":"bytes"}],"name":"SimulationResults","type":"error"},{"inputs":[{"internalType":"string","name":"str","type":"string"}],"name":"StringTooLong","type":"error"},{"inputs":[],"name":"SwapWithZeroAmount","type":"error"},{"inputs":[],"name":"TakingAmountExceeded","type":"error"},{"inputs":[],"name":"TakingAmountTooHigh","type":"error"},{"inputs":[],"name":"TransferFromMakerToTakerFailed","type":"error"},{"inputs":[],"name":"TransferFromTakerToMakerFailed","type":"error"},{"inputs":[],"name":"WrongSeriesNonce","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"maker","type":"address"},{"indexed":false,"internalType":"uint256","name":"slotIndex","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"slotValue","type":"uint256"}],"name":"BitInvalidatorUpdated","type":"event"},{"anonymous":false,"inputs":[],"name":"EIP712DomainChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"maker","type":"address"},{"indexed":false,"internalType":"uint256","name":"series","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newEpoch","type":"uint256"}],"name":"EpochIncreased","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"orderHash","type":"bytes32"}],"name":"OrderCancelled","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"orderHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"remainingAmount","type":"uint256"}],"name":"OrderFilled","type":"event"},{"inputs":[],"name":"DOMAIN_SEPARATOR","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint96","name":"series","type":"uint96"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"advanceEpoch","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"offsets","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"and","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"arbitraryStaticCall","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"uint256","name":"slot","type":"uint256"}],"name":"bitInvalidatorForOrder","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"},{"internalType":"uint256","name":"additionalMask","type":"uint256"}],"name":"bitsInvalidateForOrder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"},{"internalType":"bytes32","name":"orderHash","type":"bytes32"}],"name":"cancelOrder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"MakerTraits[]","name":"makerTraits","type":"uint256[]"},{"internalType":"bytes32[]","name":"orderHashes","type":"bytes32[]"}],"name":"cancelOrders","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes","name":"predicate","type":"bytes"}],"name":"checkPredicate","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"eip712Domain","outputs":[{"internalType":"bytes1","name":"fields","type":"bytes1"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"version","type":"string"},{"internalType":"uint256","name":"chainId","type":"uint256"},{"internalType":"address","name":"verifyingContract","type":"address"},{"internalType":"bytes32","name":"salt","type":"bytes32"},{"internalType":"uint256[]","name":"extensions","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"uint96","name":"series","type":"uint96"}],"name":"epoch","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"uint256","name":"series","type":"uint256"},{"internalType":"uint256","name":"makerEpoch","type":"uint256"}],"name":"epochEquals","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"eq","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"Address","name":"maker","type":"uint256"},{"internalType":"Address","name":"receiver","type":"uint256"},{"internalType":"Address","name":"makerAsset","type":"uint256"},{"internalType":"Address","name":"takerAsset","type":"uint256"},{"internalType":"uint256","name":"makingAmount","type":"uint256"},{"internalType":"uint256","name":"takingAmount","type":"uint256"},{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"}],"internalType":"struct IOrderMixin.Order","name":"order","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"TakerTraits","name":"takerTraits","type":"uint256"}],"name":"fillContractOrder","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"Address","name":"maker","type":"uint256"},{"internalType":"Address","name":"receiver","type":"uint256"},{"internalType":"Address","name":"makerAsset","type":"uint256"},{"internalType":"Address","name":"takerAsset","type":"uint256"},{"internalType":"uint256","name":"makingAmount","type":"uint256"},{"internalType":"uint256","name":"takingAmount","type":"uint256"},{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"}],"internalType":"struct IOrderMixin.Order","name":"order","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"TakerTraits","name":"takerTraits","type":"uint256"},{"internalType":"bytes","name":"args","type":"bytes"}],"name":"fillContractOrderArgs","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"Address","name":"maker","type":"uint256"},{"internalType":"Address","name":"receiver","type":"uint256"},{"internalType":"Address","name":"makerAsset","type":"uint256"},{"internalType":"Address","name":"takerAsset","type":"uint256"},{"internalType":"uint256","name":"makingAmount","type":"uint256"},{"internalType":"uint256","name":"takingAmount","type":"uint256"},{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"}],"internalType":"struct IOrderMixin.Order","name":"order","type":"tuple"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"vs","type":"bytes32"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"TakerTraits","name":"takerTraits","type":"uint256"}],"name":"fillOrder","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"Address","name":"maker","type":"uint256"},{"internalType":"Address","name":"receiver","type":"uint256"},{"internalType":"Address","name":"makerAsset","type":"uint256"},{"internalType":"Address","name":"takerAsset","type":"uint256"},{"internalType":"uint256","name":"makingAmount","type":"uint256"},{"internalType":"uint256","name":"takingAmount","type":"uint256"},{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"}],"internalType":"struct IOrderMixin.Order","name":"order","type":"tuple"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"vs","type":"bytes32"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"TakerTraits","name":"takerTraits","type":"uint256"},{"internalType":"bytes","name":"args","type":"bytes"}],"name":"fillOrderArgs","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"gt","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"Address","name":"maker","type":"uint256"},{"internalType":"Address","name":"receiver","type":"uint256"},{"internalType":"Address","name":"makerAsset","type":"uint256"},{"internalType":"Address","name":"takerAsset","type":"uint256"},{"internalType":"uint256","name":"makingAmount","type":"uint256"},{"internalType":"uint256","name":"takingAmount","type":"uint256"},{"internalType":"MakerTraits","name":"makerTraits","type":"uint256"}],"internalType":"struct IOrderMixin.Order","name":"order","type":"tuple"}],"name":"hashOrder","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint96","name":"series","type":"uint96"}],"name":"increaseEpoch","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"lt","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"data","type":"bytes"}],"name":"not","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"offsets","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"or","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"permit","type":"bytes"},{"internalType":"bytes","name":"action","type":"bytes"}],"name":"permitAndCall","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"bytes32","name":"orderHash","type":"bytes32"}],"name":"rawRemainingInvalidatorForOrder","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"maker","type":"address"},{"internalType":"bytes32","name":"orderHash","type":"bytes32"}],"name":"remainingInvalidatorForOrder","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"simulate","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]');new i.vU(s);const o=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],u=[{name:"salt",type:"uint256"},{name:"maker",type:"address"},{name:"receiver",type:"address"},{name:"makerAsset",type:"address"},{name:"takerAsset",type:"address"},{name:"makingAmount",type:"uint256"},{name:"takingAmount",type:"uint256"},{name:"makerTraits",type:"uint256"}];var l=n(98074);const m="0x",p=e=>324===e?"0x6fd4383cb451173d5f9304f041c7bcbf27d561ff":"0x111111125421ca6dc452d289314280a0f8842a65";var y=n(97179),d=n(12675);class h{constructor(e){this.value=new d.BN(e)}static default(){return new h(0n)}allowedSender(){return this.value.getMask(h.ALLOWED_SENDER_MASK).value.toString(16).padStart(20,"0")}isPrivate(){return 0n!==this.value.getMask(h.ALLOWED_SENDER_MASK).value}withAllowedSender(e){a()(!e.isZero(),"Use withAnySender() to remove sender check");const t=(0,d.add0x)(e.toString().slice(-20));return this.value=this.value.setMask(h.ALLOWED_SENDER_MASK,BigInt(t)),this}withAnySender(){return this.value=this.value.setMask(h.ALLOWED_SENDER_MASK,BigInt(0)),this}expiration(){const e=this.value.getMask(h.EXPIRATION_MASK);return e.isZero()?null:e.value}withExpiration(e){const t=null===e?0n:e;return this.value=this.value.setMask(h.EXPIRATION_MASK,t),this}nonceOrEpoch(){return this.value.getMask(h.NONCE_OR_EPOCH_MASK).value}withNonce(e){return this.value=this.value.setMask(h.NONCE_OR_EPOCH_MASK,e),this}withEpoch(e,t){return this.setSeries(e),this.enableEpochManagerCheck(),this.withNonce(t)}series(){return this.value.getMask(h.SERIES_MASK).value}hasExtension(){return 1===this.value.getBit(h.HAS_EXTENSION_FLAG)}withExtension(){return this.value=this.value.setBit(h.HAS_EXTENSION_FLAG,1),this}isPartialFillAllowed(){return 0===this.value.getBit(h.NO_PARTIAL_FILLS_FLAG)}disablePartialFills(){return this.value=this.value.setBit(h.NO_PARTIAL_FILLS_FLAG,1),this}allowPartialFills(){return this.value=this.value.setBit(h.NO_PARTIAL_FILLS_FLAG,0),this}setPartialFills(e){return e?this.allowPartialFills():this.disablePartialFills()}isMultipleFillsAllowed(){return 1===this.value.getBit(h.ALLOW_MULTIPLE_FILLS_FLAG)}allowMultipleFills(){return this.value=this.value.setBit(h.ALLOW_MULTIPLE_FILLS_FLAG,1),this}disableMultipleFills(){return this.value=this.value.setBit(h.ALLOW_MULTIPLE_FILLS_FLAG,0),this}setMultipleFills(e){return e?this.allowMultipleFills():this.disableMultipleFills()}hasPreInteraction(){return 1===this.value.getBit(h.PRE_INTERACTION_CALL_FLAG)}enablePreInteraction(){return this.value=this.value.setBit(h.PRE_INTERACTION_CALL_FLAG,1),this}disablePreInteraction(){return this.value=this.value.setBit(h.PRE_INTERACTION_CALL_FLAG,0),this}hasPostInteraction(){return 1===this.value.getBit(h.POST_INTERACTION_CALL_FLAG)}enablePostInteraction(){return this.value=this.value.setBit(h.POST_INTERACTION_CALL_FLAG,1),this}disablePostInteraction(){return this.value=this.value.setBit(h.POST_INTERACTION_CALL_FLAG,0),this}isEpochManagerEnabled(){return 1===this.value.getBit(h.NEED_CHECK_EPOCH_MANAGER_FLAG)}isPermit2(){return 1===this.value.getBit(h.USE_PERMIT2_FLAG)}enablePermit2(){return this.value=this.value.setBit(h.USE_PERMIT2_FLAG,1),this}disablePermit2(){return this.value=this.value.setBit(h.USE_PERMIT2_FLAG,0),this}isNativeUnwrapEnabled(){return 1===this.value.getBit(h.UNWRAP_WETH_FLAG)}enableNativeUnwrap(){return this.value=this.value.setBit(h.UNWRAP_WETH_FLAG,1),this}disableNativeUnwrap(){return this.value=this.value.setBit(h.UNWRAP_WETH_FLAG,0),this}asBigInt(){return this.value.value}isBitInvalidatorMode(){return!this.isPartialFillAllowed()||!this.isMultipleFillsAllowed()}enableEpochManagerCheck(){a()(!this.isBitInvalidatorMode(),"Epoch manager allowed only when partialFills and multipleFills enabled"),this.value=this.value.setBit(h.NEED_CHECK_EPOCH_MANAGER_FLAG,1)}setSeries(e){this.value=this.value.setMask(h.SERIES_MASK,e)}}h.ALLOWED_SENDER_MASK=new d.BitMask(0n,80n),h.EXPIRATION_MASK=new d.BitMask(80n,120n),h.NONCE_OR_EPOCH_MASK=new d.BitMask(120n,160n),h.SERIES_MASK=new d.BitMask(160n,200n),h.NO_PARTIAL_FILLS_FLAG=255n,h.ALLOW_MULTIPLE_FILLS_FLAG=254n,h.PRE_INTERACTION_CALL_FLAG=252n,h.POST_INTERACTION_CALL_FLAG=251n,h.NEED_CHECK_EPOCH_MANAGER_FLAG=250n,h.HAS_EXTENSION_FLAG=249n,h.USE_PERMIT2_FLAG=248n,h.UNWRAP_WETH_FLAG=247n;var c=n(35831);class A{constructor(e=A.EMPTY){this.makerAssetSuffix=m,this.takerAssetSuffix=m,this.makingAmountData=m,this.takingAmountData=m,this.predicate=m,this.makerPermit=m,this.preInteraction=m,this.postInteraction=m,this.customData=m,Object.entries(e).forEach((([e,t])=>a()((0,d.isHexString)(t)||t===m,`${e} must be valid hex string`))),this.makerAssetSuffix=e.makerAssetSuffix,this.takerAssetSuffix=e.takerAssetSuffix,this.makingAmountData=e.makingAmountData,this.takingAmountData=e.takingAmountData,this.predicate=e.predicate,this.makerPermit=e.makerPermit,this.preInteraction=e.preInteraction,this.postInteraction=e.postInteraction,this.customData=e.customData}get hasPredicate(){return this.predicate!==m}get hasMakerPermit(){return this.makerPermit!==m}static decode(e){if(e===m)return A.default();const t=d.BytesIter.HexString(e);let n=BigInt(t.nextUint256()),i=0;const r={};for(const e of A.fields){const a=Number(n&d.UINT_32_MAX)-i;r[e]=t.nextBytes(a),i+=a,n>>=32n}return r.customData=t.rest(),new A(r)}static default(){return new A}keccak256(){return BigInt((0,c.w)(this.encode()))}isEmpty(){return 0===(this.getAll().map(d.trim0x).join("")+(0,d.trim0x)(this.customData)).length}encode(){const e=this.getAll(),t=e.map(d.trim0x).join("")+(0,d.trim0x)(this.customData),n=(i=0,e=>i+=e);var i;const r=e.map((e=>e.length/2-1)).map(n).reduce(((e,t,n)=>e+(BigInt(t)<<BigInt(32*n))),0n);let a="0x";return t.length>0&&(a+=r.toString(16).padStart(64,"0")+t),a}getAll(){return A.fields.map((e=>this[e]))}}A.EMPTY={makerAssetSuffix:m,takerAssetSuffix:m,makingAmountData:m,takingAmountData:m,predicate:m,makerPermit:m,preInteraction:m,postInteraction:m,customData:m},A.fields=["makerAssetSuffix","takerAssetSuffix","makingAmountData","takingAmountData","predicate","makerPermit","preInteraction","postInteraction"];var g=n(22695);const T=new d.BitMask(224n,256n);function f(e){return BigInt((0,d.add0x)((0,g.id)(e).slice(0,10)))}function k(e,t){const n=t?function(e){return(0,d.isHexString)(e)?10===e.length?BigInt(e):66===e.length?BigInt(e.substring(0,10)):f(e):f(e)}(t):0n;return new d.BN(e).setMask(T,n).value}var E=n(57373);class v{constructor(e){a()((0,E.UJ)(e),`Invalid address ${e}`),this.val=e.toLowerCase()}static fromBigInt(e){return new v((0,d.add0x)(e.toString(16).padStart(40,"0")))}static fromFirstBytes(e){return new v(e.slice(0,42))}toString(){return this.val}equal(e){return this.val===e.val}isNative(){return this.equal(v.NATIVE_CURRENCY)}isZero(){return this.equal(v.ZERO_ADDRESS)}lastHalf(){return(0,d.add0x)(this.val.slice(-20))}}v.NATIVE_CURRENCY=new v("0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"),v.ZERO_ADDRESS=new v("0x0000000000000000000000000000000000000000");var b,_,S=n(65960);function I(e){let t=0,n=e=BigInt(e)+1n;for(;n;)n>>=8n,t+=1;return(0,S.O)(t).reduce(((e,t,n)=>e+(BigInt(t)<<BigInt(8*n))),0n)%e}class F{constructor(e,t=new h(0n),n=A.default()){this.extension=n,a()(!e.takerAsset.isNative(),`${e.takerAsset} can not be 'takerAsset'. Use wrapper address as 'takerAsset' and 'makerTraits.enableNativeUnwrap' to swap to NATIVE currency`),a()(!e.makerAsset.isNative(),"Maker asset can not be NATIVE, use wrapper"),this.makerAsset=e.makerAsset,this.takerAsset=e.takerAsset,this.makingAmount=e.makingAmount,this.takingAmount=e.takingAmount,this._salt=F.verifySalt(e.salt||F.buildSalt(n),n),this.maker=e.maker,this.receiver=e.receiver?.equal(e.maker)?v.ZERO_ADDRESS:e.receiver||v.ZERO_ADDRESS,this.makerTraits=t,a()(this.makingAmount<=d.UINT_256_MAX,"makingAmount too big"),a()(this.takingAmount<=d.UINT_256_MAX,"takingAmount too big"),n.isEmpty()||this.makerTraits.withExtension()}get salt(){return this._salt}static buildSalt(e,t=I((1n<<96n)-1n)){return e.isEmpty()?t:t<<160n|e.keccak256()&d.UINT_160_MAX}static verifySalt(e,t){if(a()(e<=d.UINT_256_MAX,"salt too big"),t.isEmpty())return e;const n=e&d.UINT_160_MAX,i=t.keccak256()&d.UINT_160_MAX;return a()(n===i,"invalid salt: lowest 160 bits should be extension hash"),e}static fromCalldata(e){a()((0,d.isHexString)(e),"Bytes should be valid hex string with 0x prefix");const t=y.R.defaultAbiCoder().decode([F.Web3Type],e)[0];return new F({salt:t.salt?BigInt(t.salt):void 0,maker:new v(t.maker),receiver:new v(t.receiver),takingAmount:BigInt(t.takingAmount),makingAmount:BigInt(t.makingAmount),takerAsset:new v(t.takerAsset),makerAsset:new v(t.makerAsset)},new h(BigInt(t.makerTraits)))}static fromDataAndExtension(e,t){return new F({salt:BigInt(e.salt),maker:new v(e.maker),receiver:new v(e.receiver),takingAmount:BigInt(e.takingAmount),makingAmount:BigInt(e.makingAmount),takerAsset:new v(e.takerAsset),makerAsset:new v(e.makerAsset)},new h(BigInt(e.makerTraits)),t)}setSource(e){return this._salt=k(this.salt,e),this}toCalldata(){return y.R.defaultAbiCoder().encode([F.Web3Type],[this.build()])}build(){return{maker:this.maker.toString(),makerAsset:this.makerAsset.toString(),takerAsset:this.takerAsset.toString(),makerTraits:(this.makerTraits?.asBigInt()||0n).toString(),salt:this.salt.toString(),makingAmount:this.makingAmount.toString(),takingAmount:this.takingAmount.toString(),receiver:this.receiver.toString()}}getTypedData(e){const t=function(e){return{name:"1inch Aggregation Router",version:"6",chainId:e,verifyingContract:p(e)}}(e);return function(e,t,n,i,r){return{primaryType:"Order",types:{EIP712Domain:o,Order:u},domain:{name:n,version:i,chainId:e,verifyingContract:t},message:r}}(t.chainId,t.verifyingContract,t.name,t.version,this.build())}getOrderHash(e){return t=this.getTypedData(e),l.E.hash(t.domain,{Order:t.types.Order},t.message);var t}isPrivate(){return this.makerTraits.isPrivate()}}F.Web3Type=`tuple(${["uint256 salt","address maker","address receiver","address makerAsset","address takerAsset","uint256 makingAmount","uint256 takingAmount","uint256 makerTraits"]})`;class w{constructor(e){this.value=e,a()(e>=0&&e<=1e4,`invalid bps ${e}`)}static fromPercent(e,t=1n){return new w(BigInt(100*e)/t)}static fromFraction(e,t=1n){return new w(BigInt(1e4*e)/t)}equal(e){return this.value===e.value}isZero(){return 0n===this.value}toPercent(e=1n){return Number(this.value*e)/100}toFraction(e=1n){return Number(this.value*e)/1e4}toString(){return this.value.toString()}}w.ZERO=new w(0n);class M{constructor(e,t,n=w.ZERO){if(this.receiver=e,this.fee=t,this.whitelistDiscount=n,e.isZero()&&!t.isZero())throw new Error("fee must be zero if receiver is zero address");if(!e.isZero()&&t.isZero())throw new Error("receiver must be zero address if fee is zero");if(t.isZero()&&!n.isZero())throw new Error("whitelist discount must be zero if fee is zero");a()(this.whitelistDiscount.value%100n===0n,"whitelist discount must have percent precision: 1%, 2% and so on")}}M.ZERO=new M(v.ZERO_ADDRESS,w.ZERO);class B{constructor(e,t,n,i){if(this.integrator=e,this.protocol=t,this.fee=n,this.share=i,n.isZero()){if(!i.isZero())throw new Error("integrator share must be zero if fee is zero");if(!e.isZero())throw new Error("integrator address must be zero if fee is zero");if(!t.isZero())throw new Error("protocol address must be zero if fee is zero")}if((e.isZero()||t.isZero())&&!n.isZero())throw new Error("fee must be zero if integrator or protocol is zero address")}}B.ZERO=new B(v.ZERO_ADDRESS,v.ZERO_ADDRESS,w.ZERO,w.ZERO);class x{constructor(e,t){this.resolver=e,this.integrator=t,e.fee.isZero()||t.fee.isZero()||a()(e.receiver.equal(t.protocol),"resolver fee receiver address and integrator fee protocol address must be same"),a()(!(e.fee.isZero()&&t.fee.isZero()),"at least one fee must be set"),a()(this.integrator.fee.toFraction()<.6553,"max fee is 65.53%"),a()(this.resolver.fee.toFraction()<.6553,"max fee is 65.53%")}get protocol(){return this.integrator.fee.isZero()?this.resolver.receiver:this.integrator.protocol}static resolverFee(e){return new x(e,B.ZERO)}static integratorFee(e){return new x(M.ZERO,e)}}x.BASE_1E5=100000n,x.BASE_1E2=100n;class R{constructor(e){this.addresses=e}get length(){return this.addresses.length}static new(e){return new R(e?.map((e=>e.lastHalf()))||[])}isWhitelisted(e){const t=e.lastHalf();return this.addresses.some((e=>e===t))}encodeTo(e){e.addUint8(BigInt(this.addresses.length));for(const t of this.addresses)e.addBytes(t);return e}}function O(e,t,n,i=b.Floor){const r=e*t/n;return i===b.Ceil&&e*t%n>0?r+1n:r}!function(e){e[e.Ceil=0]="Ceil",e[e.Floor=1]="Floor"}(b||(b={}));class L{constructor(e,t){this.fees=e,this.whitelist=t}getTakingAmount(e,t){const n=this.getFeesForTaker(e);return O(t,x.BASE_1E5+n.resolverFee+n.integratorFee,x.BASE_1E5,b.Ceil)}getMakingAmount(e,t){const n=this.getFeesForTaker(e);return O(t,x.BASE_1E5,x.BASE_1E5+n.resolverFee+n.integratorFee)}getResolverFee(e,t){const n=this.getTakingAmount(e,t),i=this.getFeesForTaker(e);return O(n,i.resolverFee,x.BASE_1E5+i.resolverFee+i.integratorFee)}getIntegratorFee(e,t){const n=this.getTakingAmount(e,t),i=this.getFeesForTaker(e),r=O(n,i.integratorFee,x.BASE_1E5+i.resolverFee+i.integratorFee);return O(r,BigInt(this.fees.integrator.share.toFraction(x.BASE_1E2)),x.BASE_1E2)}getProtocolShareOfIntegratorFee(e,t){const n=this.getTakingAmount(e,t),i=this.getFeesForTaker(e);return O(n,i.integratorFee,x.BASE_1E5+i.resolverFee+i.integratorFee)-this.getIntegratorFee(e,t)}getProtocolFee(e,t){const n=this.getResolverFee(e,t);return this.getProtocolShareOfIntegratorFee(e,t)+n}getFeesForTaker(e){const t=this.whitelist.isWhitelisted(e)?Number(x.BASE_1E2)-this.fees.resolver.whitelistDiscount.toFraction(x.BASE_1E2):100,n=BigInt(t*this.fees.resolver.fee.toFraction(x.BASE_1E5))/x.BASE_1E2;return{resolverFee:BigInt(n),integratorFee:BigInt(this.fees.integrator.fee.toFraction(x.BASE_1E5))}}}class N{constructor(){this.makerAssetSuffix=m,this.takerAssetSuffix=m,this.makingAmountData=m,this.takingAmountData=m,this.predicate=m,this.makerPermit=m,this.preInteraction=m,this.postInteraction=m,this.customData=m}withMakerAssetSuffix(e){return a()((0,d.isHexString)(e),"MakerAssetSuffix must be valid hex string"),this.makerAssetSuffix=e,this}withTakerAssetSuffix(e){return a()((0,d.isHexString)(e),"TakerAssetSuffix must be valid hex string"),this.takerAssetSuffix=e,this}withMakingAmountData(e,t){return a()((0,d.isHexString)(t),"MakingAmountData must be valid hex string"),this.makingAmountData=e.toString()+(0,d.trim0x)(t),this}withTakingAmountData(e,t){return a()((0,d.isHexString)(t),"TakingAmountData must be valid hex string"),this.takingAmountData=e.toString()+(0,d.trim0x)(t),this}withPredicate(e){return a()((0,d.isHexString)(e),"Predicate must be valid hex string"),this.predicate=e,this}withMakerPermit(e,t){return a()((0,d.isHexString)(t),"Permit data must be valid hex string"),this.makerPermit=e.toString()+(0,d.trim0x)(t),this}withPreInteraction(e){return this.preInteraction=e.encode(),this}withPostInteraction(e){return this.postInteraction=e.encode(),this}withCustomData(e){return a()((0,d.isHexString)(e),"Custom data must be valid hex string"),this.customData=e,this}build(){return new A({makerAssetSuffix:this.makerAssetSuffix,takerAssetSuffix:this.takerAssetSuffix,makingAmountData:this.makingAmountData,takingAmountData:this.takingAmountData,predicate:this.predicate,makerPermit:this.makerPermit,preInteraction:this.preInteraction,postInteraction:this.postInteraction,customData:this.customData})}}class P{constructor(e,t){this.target=e,this.data=t,a()((0,d.isHexBytes)(t),"Interaction data must be valid hex bytes")}static decode(e){const t=d.BytesIter.HexString(e);return new P(new v(t.nextUint160()),t.rest())}encode(){return this.target.toString()+(0,d.trim0x)(this.data)}}class D{constructor(e,t,n,i,r,a){this.address=e,this.fees=t,this.whitelist=n,this.makerPermit=i,this.extraInteraction=r,this.customReceiver=a}static new(e,t,n,i){return new D(e,t,R.new(n||[]),i?.makerPermit,i?.extraInteraction,i?.customReceiver)}static decode(e){const t=A.decode(e);return D.fromExtension(t)}static fromExtension(e){const t=v.fromFirstBytes(e.makingAmountData);a()(v.fromFirstBytes(e.takingAmountData).equal(t)&&v.fromFirstBytes(e.postInteraction).equal(t),"Invalid extension, all calls should be to the same address"),a()(e.takingAmountData==e.makingAmountData,"Invalid extension, taking amount data must be equal to making amount data");const n=d.BytesIter.HexString(e.postInteraction);n.nextUint160();const i=d.BN.fromHex(n.nextUint8()),r=new v(n.nextUint160()),s=new v(n.nextUint160()),o=i.getBit(D.CUSTOM_RECEIVER_FLAG_BIT)?new v(n.nextUint160()):void 0,u=C(n),l=n.isEmpty()?void 0:P.decode(n.rest()),m=d.BytesIter.HexString(e.makingAmountData);m.nextUint160();const p=C(m),y=e.hasMakerPermit?P.decode(e.makerPermit):void 0;return a()(p.fees.integratorFee.value===u.fees.integratorFee.value,"invalid extension: integrator fee must be same in interaction data and in amount data"),a()(p.fees.resolverFee.value===u.fees.resolverFee.value,"invalid extension: resolver fee must be same in interaction data and in amount data"),a()(p.whitelist.discount.value===u.whitelist.discount.value,"invalid extension: whitelist discount fee must be same in interaction data and in amount data"),a()(p.fees.integratorShare.value===u.fees.integratorShare.value,"invalid extension: integrator share must be same in interaction data and in amount data"),a()(u.whitelist.addresses.length===p.whitelist.addresses.length,"whitelist must be same in interaction data and in amount data"),a()(u.whitelist.addresses.every(((e,t)=>p.whitelist.addresses[t]===e)),"whitelist must be same in interaction data and in amount data"),new D(t,new x(p.fees.resolverFee.isZero()?M.ZERO:new M(s,p.fees.resolverFee,p.whitelist.discount),p.fees.integratorFee.isZero()?B.ZERO:new B(r,s,p.fees.integratorFee,p.fees.integratorShare)),new R(p.whitelist.addresses),y,l,o)}getFeeCalculator(){return new L(this.fees,this.whitelist)}build(){const e=this.buildAmountGetterData(),t=(new N).withMakingAmountData(this.address,e).withTakingAmountData(this.address,e).withPostInteraction(new P(this.address,this.buildInteractionData()));return this.makerPermit&&t.withMakerPermit(this.makerPermit.target,this.makerPermit.data),t.build()}getTakingAmount(e,t){return this.getFeeCalculator().getTakingAmount(e,t)}getMakingAmount(e,t){return this.getFeeCalculator().getMakingAmount(e,t)}getResolverFee(e,t){return this.getFeeCalculator().getResolverFee(e,t)}getIntegratorFee(e,t){return this.getFeeCalculator().getIntegratorFee(e,t)}getProtocolShareOfIntegratorFee(e,t){return this.getFeeCalculator().getProtocolShareOfIntegratorFee(e,t)}getProtocolFee(e,t){return this.getFeeCalculator().getProtocolFee(e,t)}buildAmountGetterData(){const e={fee:this.fees.integrator.fee.toFraction(x.BASE_1E5),share:this.fees.integrator.share.toFraction(x.BASE_1E2)},t=this.fees.resolver.fee.toFraction(x.BASE_1E5),n=(new d.BytesBuilder).addUint16(BigInt(e.fee)).addUint8(BigInt(e.share)).addUint16(BigInt(t)).addUint8(BigInt(Number(x.BASE_1E2)-this.fees.resolver.whitelistDiscount.toFraction(x.BASE_1E2)));return this.whitelist.encodeTo(n),n.asHex()}buildInteractionData(){const e=new d.BN(0n).setBit(D.CUSTOM_RECEIVER_FLAG_BIT,Boolean(this.customReceiver)),t=(new d.BytesBuilder).addUint8(e).addAddress(this.fees.integrator.integrator.toString()).addAddress(this.fees.protocol.toString());return this.customReceiver&&t.addAddress(this.customReceiver.toString()),t.addBytes(this.buildAmountGetterData()),this.extraInteraction&&t.addAddress(this.extraInteraction.target.toString()).addBytes(this.extraInteraction.data),t.asHex()}}function C(e){const t={integratorFee:w.fromFraction(Number(e.nextUint16()),x.BASE_1E5),integratorShare:w.fromFraction(Number(e.nextUint8()),x.BASE_1E2),resolverFee:w.fromFraction(Number(e.nextUint16()),x.BASE_1E5)},n=w.fromFraction(Number(x.BASE_1E2)-Number(e.nextUint8()),x.BASE_1E2),i=[],r=Number(e.nextUint8());for(let t=0;t<r;t++)i.push(e.nextBytes(10));return{fees:t,whitelist:{discount:n,addresses:i}}}D.CUSTOM_RECEIVER_FLAG_BIT=0n;!function(e){e[e.taker=0]="taker",e[e.maker=1]="maker"}(_||(_={}));class H{constructor(e,t){this.flags=new d.BN(e),this.receiver=t.receiver,this.extension=t.extension,this.interaction=t.interaction}static default(){return new H(0n,{})}getAmountMode(){return this.flags.getBit(H.MAKER_AMOUNT_FLAG)}setAmountMode(e){return this.flags=this.flags.setBit(H.MAKER_AMOUNT_FLAG,e),this}isNativeUnwrapEnabled(){return 1===this.flags.getBit(H.UNWRAP_WETH_FLAG)}enableNativeUnwrap(){return this.flags=this.flags.setBit(H.UNWRAP_WETH_FLAG,1),this}disableNativeUnwrap(){return this.flags=this.flags.setBit(H.UNWRAP_WETH_FLAG,0),this}isOrderPermitSkipped(){return Boolean(this.flags.getBit(H.SKIP_ORDER_PERMIT_FLAG))}skipOrderPermit(){return this.flags=this.flags.setBit(H.SKIP_ORDER_PERMIT_FLAG,1),this}isPermit2Enabled(){return 1===this.flags.getBit(H.USE_PERMIT2_FLAG)}enablePermit2(){return this.flags=this.flags.setBit(H.USE_PERMIT2_FLAG,1),this}disablePermit2(){return this.flags=this.flags.setBit(H.USE_PERMIT2_FLAG,0),this}setReceiver(e){return this.receiver=e,this}removeReceiver(){return this.receiver=void 0,this}setExtension(e){return this.extension=e,this}removeExtension(){return this.extension=void 0,this}setAmountThreshold(e){return this.flags=this.flags.setMask(H.THRESHOLD_MASK,e),this}getAmountThreshold(){return this.flags.getMask(H.THRESHOLD_MASK).value}removeAmountThreshold(){return this.flags=this.flags.setMask(H.THRESHOLD_MASK,0n),this}setInteraction(e){return this.interaction=e,this}removeInteraction(){return this.interaction=void 0,this}encode(){const e=this.extension?(0,d.getBytesCount)(this.extension.encode()):0n,t=this.interaction?(0,d.getBytesCount)(this.interaction.encode()):0n,n=this.flags.setBit(H.ARGS_HAS_RECEIVER,this.receiver?1:0).setMask(H.ARGS_EXTENSION_LENGTH_MASK,e).setMask(H.ARGS_INTERACTION_LENGTH_MASK,t),i=(this.receiver?.toString()||m)+(0,d.trim0x)(this.extension?.encode()||"")+(0,d.trim0x)(this.interaction?.encode()||"");return{trait:n.value,args:i}}}H.MAKER_AMOUNT_FLAG=255n,H.UNWRAP_WETH_FLAG=254n,H.SKIP_ORDER_PERMIT_FLAG=253n,H.USE_PERMIT2_FLAG=252n,H.ARGS_HAS_RECEIVER=251n,H.THRESHOLD_MASK=new d.BitMask(0n,185n),H.ARGS_INTERACTION_LENGTH_MASK=new d.BitMask(200n,224n),H.ARGS_EXTENSION_LENGTH_MASK=new d.BitMask(224n,248n);Error}}]);
//# sourceMappingURL=2332-ac16747d7d836706.js.map