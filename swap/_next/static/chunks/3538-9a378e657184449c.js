"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3538],{94739:function(t,e,r){r.d(e,{DS:function(){return E},QJ:function(){return n},SW:function(){return N},m6:function(){return O},sX:function(){return a},uJ:function(){return c}});var n,o,c,i,s,a,u=r(67292),R=r(906);r(1323);!function(t){t[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",t[t.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",t[t.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",t[t.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",t[t.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(n||(n={})),function(t){t[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(o||(o={})),function(t){t[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",t[t.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",t[t.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(c||(c={})),function(t){t[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",t[t.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",t[t.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(i||(i={})),function(t){t[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",t[t.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(s||(s={})),function(t){t.MAINNET="-239",t.TESTNET="-3"}(a||(a={}));const E={encode:function(t,e=!1){let r;return t instanceof Uint8Array?r=t:("string"!=typeof t&&(t=JSON.stringify(t)),r=u.decodeUTF8(t)),function(t,e){const r=u.encodeBase64(t);return e?encodeURIComponent(r):r}(r,e)},decode:function(t,e=!1){const r=function(t,e){return e&&(t=decodeURIComponent(t)),u.decodeBase64(t)}(t,e);return{toString(){return u.encodeUTF8(r)},toObject(){try{return JSON.parse(u.encodeUTF8(r))}catch(t){return null}},toUint8Array(){return r}}}};function f(t){let e="";return t.forEach((t=>{e+=("0"+(255&t).toString(16)).slice(-2)})),e}function N(t){if(t.length%2!=0)throw new Error(`Cannot convert ${t} to bytesArray`);const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=parseInt(t.slice(r,r+2),16);return e}class O{constructor(t){this.nonceLength=24,this.keyPair=t?this.createKeypairFromString(t):this.createKeypair(),this.sessionId=f(this.keyPair.publicKey)}createKeypair(){return R.box.keyPair()}createKeypairFromString(t){return{publicKey:N(t.publicKey),secretKey:N(t.secretKey)}}createNonce(){return R.randomBytes(this.nonceLength)}encrypt(t,e){const r=(new TextEncoder).encode(t),n=this.createNonce();return function(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}(n,R.box(r,n,e,this.keyPair.secretKey))}decrypt(t,e){const[r,n]=function(t,e){if(e>=t.length)throw new Error("Index is out of buffer");return[t.slice(0,e),t.slice(e)]}(t,this.nonceLength),o=R.box.open(n,r,e,this.keyPair.secretKey);if(!o)throw new Error(`Decryption error: \n message: ${t.toString()} \n sender pubkey: ${e.toString()} \n keypair pubkey: ${this.keyPair.publicKey.toString()} \n keypair secretkey: ${this.keyPair.secretKey.toString()}`);return(new TextDecoder).decode(o)}stringifyKeypair(){return{publicKey:f(this.keyPair.publicKey),secretKey:f(this.keyPair.secretKey)}}}},6493:function(t,e,r){r.r(e),r.d(e,{Decoder:function(){return p},Encoder:function(){return _},PacketType:function(){return h},protocol:function(){return y}});var n=r(50017);const o="function"==typeof ArrayBuffer,c=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===c.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===c.call(File);function a(t){return o&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||i&&t instanceof Blob||s&&t instanceof File}function u(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,r=t.length;e<r;e++)if(u(t[e]))return!0;return!1}if(a(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return u(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&u(t[e]))return!0;return!1}function R(t){const e=[],r=t.data,n=t;return n.data=E(r,e),n.attachments=e.length,{packet:n,buffers:e}}function E(t,e){if(!t)return t;if(a(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=E(t[n],e);return r}if("object"==typeof t&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=E(t[n],e));return r}return t}function f(t,e){return t.data=N(t.data,e),delete t.attachments,t}function N(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=N(t[r],e);else if("object"==typeof t)for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=N(t[r],e));return t}const O=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],y=5;var h;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(h||(h={}));class _{constructor(t){this.replacer=t}encode(t){return t.type!==h.EVENT&&t.type!==h.ACK||!u(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===h.EVENT?h.BINARY_EVENT:h.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==h.BINARY_EVENT&&t.type!==h.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=R(t),r=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(r),n}}function l(t){return"[object Object]"===Object.prototype.toString.call(t)}class p extends n.Q{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const r=e.type===h.BINARY_EVENT;r||e.type===h.BINARY_ACK?(e.type=r?h.EVENT:h.ACK,this.reconstructor=new d(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const r={type:Number(t.charAt(0))};if(void 0===h[r.type])throw new Error("unknown packet type "+r.type);if(r.type===h.BINARY_EVENT||r.type===h.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const o=t.substring(n,e);if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}r.nsp=t.substring(n,e)}else r.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const r=t.charAt(e);if(null==r||Number(r)!=r){--e;break}if(e===t.length)break}r.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!p.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case h.CONNECT:return l(e);case h.DISCONNECT:return void 0===e;case h.CONNECT_ERROR:return"string"==typeof e||l(e);case h.EVENT:case h.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===O.indexOf(e[0]));case h.ACK:case h.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class d{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=f(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}}}]);
//# sourceMappingURL=3538-9a378e657184449c.js.map