"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5230],{67624:function(t,e,i){i.d(e,{g:function(){return s}});var n=i(2332),r=i(1343);const s={[r.Kz.ETHEREUM]:new n.kL("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"),[r.Kz.BINANCE]:new n.kL("0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"),[r.Kz.POLYGON]:new n.kL("0x0d500b1d8e8ef31e21c99d1db9a6444d3adf1270"),[r.Kz.ARBITRUM]:new n.kL("0x82af49447d8a07e3bd95bd0d56f35241523fbab1"),[r.Kz.AVALANCHE]:new n.kL("0xb31f66aa3c1e785363f0875a1b74e27b85fd66c7"),[r.Kz.GNOSIS]:new n.kL("0xe91d153e0b41518a2ce8dd3d7944fa863463a97d"),[r.Kz.COINBASE]:new n.kL("0x4200000000000000000000000000000000000006"),[r.Kz.OPTIMISM]:new n.kL("0x4200000000000000000000000000000000000006"),[r.Kz.FANTOM]:new n.kL("0x21be370d5312f44cb42ce377bc9b8a0cef1a4c83"),[r.Kz.ZKSYNC]:new n.kL("0x5aea5775959fbc2557cc8789bc1bf90a239d9a91"),[r.Kz.LINEA]:new n.kL("0xe5d7c2a44ffddf6b295a15c148167daaaf5cf34f")}},47607:function(t,e,i){i.d(e,{rI:function(){return m},Ot:function(){return w},Bz:function(){return b},FM:function(){return f}});var n=i(2332),r=i(70159),s=i.n(r),a=i(99463),o=i(55260);const l=/^(0x)[0-9a-f]+$/i;function d(t){return l.test(t.toLowerCase())}function c(t){return d(t)&&t.length%2==0}function u(t){return t.includes("0x")?t:"0x"+t}var h=i(1343);class m{constructor(t){this.startTime=BigInt(t.startTime),this.initialRateBump=BigInt(t.initialRateBump),this.duration=t.duration,this.points=t.points,this.gasCost=t.gasCost||{gasBumpEstimate:0n,gasPriceEstimate:0n},s()(this.gasCost.gasBumpEstimate<=h.iC),s()(this.gasCost.gasPriceEstimate<=h.gr),s()(this.startTime<=h.gr),s()(this.duration<=h.iC),s()(this.initialRateBump<=h.iC)}static decode(t){s()(c(t),"Invalid auction details data");const e=o.BytesIter.BigInt(t),i=e.nextUint24(),n=e.nextUint32(),r=e.nextUint32(),a=e.nextUint24(),l=Number(e.nextUint24()),d=[];for(;!e.isEmpty();)d.push({coefficient:Number(e.nextUint24()),delay:Number(e.nextUint16())});return new m({startTime:r,duration:a,initialRateBump:l,points:d,gasCost:{gasBumpEstimate:i,gasPriceEstimate:n}})}static fromExtension(t){return m.decode(u(t.makingAmountData.slice(42)))}encode(){let t=a.VT(["uint24","uint32","uint32","uint24","uint24"],[this.gasCost.gasBumpEstimate,this.gasCost.gasPriceEstimate,this.startTime,this.duration,this.initialRateBump]);for(let i=0;i<this.points.length;i++)t+=(e=a.VT(["uint24","uint16"],[this.points[i].coefficient,this.points[i].delay])).startsWith("0x")?e.substring(2):e;var e;return t}}var g=i(8986);class f{constructor(t){this.whitelist=t.whitelist,this.integratorFee=t?.integratorFee,this.bankFee=t.bankFee||0n,this.resolvingStartTime=t.resolvingStartTime,this.customReceiver=t.customReceiver,this.integratorFee?.ratio&&s()(!this.integratorFee.receiver.isZero(),"Fee receiver can not be zero when fee set")}static new(t){s()(t.whitelist.length,"Whitelist can not be empty");let e=0n;const i=t.whitelist.map((e=>({addressHalf:e.address.toString().slice(-20),allowFrom:e.allowFrom<t.resolvingStartTime?t.resolvingStartTime:e.allowFrom}))).sort(((t,e)=>Number(t.allowFrom-e.allowFrom))).map((i=>{const n=i.allowFrom-t.resolvingStartTime-e;return e+=n,s()(n<h.nV,"Too big diff between timestamps"),{delay:n,addressHalf:i.addressHalf}}));return new f({...t,whitelist:i})}static decode(t){s()(c(t),"Post interaction data must be valid bytes string");const e=o.BytesIter.BigInt(t),i=new o.BN(e.nextByte(o.BytesIter.SIDE.Back));let r,a,l=0n;if(i.getBit(0n)&&(l=e.nextUint32()),i.getBit(1n)){const t=e.nextUint16(),s=e.nextUint160();r={ratio:t,receiver:n.kL.fromBigInt(s)},i.getBit(2n)&&(a=n.kL.fromBigInt(e.nextUint160()))}const d=e.nextUint32(),u=[];for(;!e.isEmpty();){const t=e.nextBytes(10).toString(16).padStart(20,"0"),i=e.nextUint16();u.push({addressHalf:t,delay:i})}return new f({integratorFee:r,bankFee:l,resolvingStartTime:d,whitelist:u,customReceiver:a})}static fromExtension(t){return f.decode(u(t.postInteraction.slice(42)))}encode(){let t=new o.BN(0n);const e=new o.BytesBuilder;this.bankFee&&(t=t.setBit(0n,1),e.addUint32(this.bankFee)),this.integratorFee?.ratio&&(t=t.setBit(1n,1),e.addUint16(this.integratorFee.ratio).addAddress(this.integratorFee.receiver.toString()),this.customReceiver&&!this.customReceiver.isZero()&&(t=t.setBit(2n,1),e.addAddress(this.customReceiver.toString()))),e.addUint32(this.resolvingStartTime);for(const t of this.whitelist)e.addBytes(u(t.addressHalf)).addUint16(t.delay);return t=t.setMask(new o.BitMask(3n,8n),BigInt(this.whitelist.length)),e.addUint8(t.value),e.asHex()}canExecuteAt(t,e){const i=t.toString().slice(-20);let n=this.resolvingStartTime;for(const t of this.whitelist){if(n+=t.delay,i===t.addressHalf)return e>=n;if(e<n)return!1}return!1}isExclusivityPeriod(t=(0,g.z)()){return 1===this.whitelist.length||this.whitelist[0].delay!==this.whitelist[1].delay&&t<=this.resolvingStartTime+this.whitelist[1].delay}isExclusiveResolver(t){const e=t.toString().slice(-20);return(1===this.whitelist.length||this.whitelist[0].delay!==this.whitelist[1].delay)&&e===this.whitelist[0].addressHalf}}class w{constructor(t,e,i,r){this.address=t,this.auctionDetails=e,this.postInteractionData=i,this.makerPermit=r,this.builder=new n.FM;const s=this.auctionDetails.encode();this.builder.withMakingAmountData(this.address,s).withTakingAmountData(this.address,s).withPostInteraction(new n.U4(this.address,this.postInteractionData.encode())),r&&this.builder.withMakerPermit(r.target,r.data)}static decode(t){const e=n.hj.decode(t);return w.fromExtension(e)}static fromExtension(t){const e=n.kL.fromFirstBytes(t.makingAmountData);s()(n.kL.fromFirstBytes(t.takingAmountData).equal(e)&&n.kL.fromFirstBytes(t.postInteraction).equal(e),"Invalid extension, all calls should be to the same address");const i=m.fromExtension(t),r=f.fromExtension(t),a=t.hasMakerPermit?n.U4.decode(t.makerPermit):void 0;return new w(e,i,r,a)}build(){return this.builder.build()}}var v=i(13619);const p=new o.BitMask(224n,256n);function k(t){return BigInt(u((0,v.id)(t).slice(0,10)))}function E(t,e){const i=e?function(t){return d(t)?10===t.length?BigInt(t):66===t.length?BigInt(t.substring(0,10)):k(t):k(t)}(e):0n;return new o.BN(t).setMask(p,i).value}var x=i(33203);class b{constructor(t,e,i,r,a=b.defaultExtra,o=new w(t,i,r,a.permit?new n.U4(e.makerAsset,a.permit):void 0)){this.settlementExtensionContract=t;const l=a.allowPartialFills??b.defaultExtra.allowPartialFills,d=a.allowMultipleFills??b.defaultExtra.allowMultipleFills,c=a.unwrapWETH??b.defaultExtra.unwrapWETH,u=a.enablePermit2??b.defaultExtra.enablePermit2,h=a.orderExpirationDelay??b.defaultExtra.orderExpirationDelay,m=i.startTime+i.duration+h,g=n.y9.default().withExpiration(m).setPartialFills(l).setMultipleFills(d).enablePostInteraction();g.isBitInvalidatorMode()&&s()(void 0!==a.nonce,"Nonce required, when partial fill or multiple fill disallowed"),c&&g.enableNativeUnwrap(),u&&g.enablePermit2(),void 0!==a.nonce&&g.withNonce(a.nonce);const f=r.integratorFee?.ratio?t:e.receiver,v=o.build(),p=n.eN.buildSalt(v,e.salt),k=e.salt?p:E(p,a.source);this.inner=new n.eN({...e,receiver:f,salt:k},g,v),this.fusionExtension=o}get extension(){return this.inner.extension}get maker(){return this.inner.maker}get takerAsset(){return this.inner.takerAsset}get makerAsset(){return this.inner.makerAsset}get takingAmount(){return this.inner.takingAmount}get makingAmount(){return this.inner.makingAmount}get receiver(){return this.inner.receiver}get deadline(){return this.inner.makerTraits.expiration()||0n}get auctionStartTime(){return this.fusionExtension.auctionDetails.startTime}get auctionEndTime(){const{startTime:t,duration:e}=this.fusionExtension.auctionDetails;return t+e}get isBitInvalidatorMode(){return this.inner.makerTraits.isBitInvalidatorMode()}get partialFillAllowed(){return this.inner.makerTraits.isPartialFillAllowed()}get multipleFillsAllowed(){return this.inner.makerTraits.isMultipleFillsAllowed()}get nonce(){return this.inner.makerTraits.nonceOrEpoch()}get salt(){return this.inner.salt}static new(t,e,i,n){return new b(t,e,i.auction,f.new({bankFee:i.fees?.bankFee||0n,integratorFee:i.fees?.integratorFee,whitelist:i.whitelist,resolvingStartTime:i.resolvingStartTime??(0,g.z)(),customReceiver:e.receiver}),n)}static fromDataAndExtension(t,e){const i=n.kL.fromFirstBytes(e.makingAmountData);s()(n.kL.fromFirstBytes(e.takingAmountData).equal(i)&&n.kL.fromFirstBytes(e.postInteraction).equal(i),"Invalid extension, all calls should be to the same address");const r=new n.y9(BigInt(t.makerTraits));s()(!r.isPrivate(),"fusion order can not be private"),s()(r.hasPostInteraction(),"post-interaction must be enabled");const a=m.fromExtension(e),o=f.fromExtension(e),l=r.expiration(),d=null===l?void 0:l-a.startTime-a.duration;return new b(i,{salt:BigInt(t.salt)>>160n,maker:new n.kL(t.maker),receiver:new n.kL(t.receiver),makerAsset:new n.kL(t.makerAsset),takerAsset:new n.kL(t.takerAsset),makingAmount:BigInt(t.makingAmount),takingAmount:BigInt(t.takingAmount)},a,o,{allowMultipleFills:r.isMultipleFillsAllowed(),allowPartialFills:r.isPartialFillAllowed(),enablePermit2:r.isPermit2(),nonce:r.nonceOrEpoch(),permit:e.makerPermit===h.ZX?void 0:n.U4.decode(e.makerPermit).data,unwrapWETH:r.isNativeUnwrapEnabled(),orderExpirationDelay:d})}build(){return this.inner.build()}getOrderHash(t){return this.inner.getOrderHash(t)}getTypedData(t){return this.inner.getTypedData(t)}getCalculator(){return x.S.fromAuctionData(this.fusionExtension.postInteractionData,this.fusionExtension.auctionDetails)}calcTakingAmount(t,e,i=0n){const n=(r=t,s=this.makingAmount,a=this.takingAmount,(r*a+s-1n)/s);var r,s,a;const o=this.getCalculator(),l=o.calcRateBump(e,i);return o.calcAuctionTakingAmount(n,l)}canExecuteAt(t,e){return this.fusionExtension.postInteractionData.canExecuteAt(t,e)}isExpiredAt(t){return t>this.deadline}getResolverFee(t){return this.fusionExtension.postInteractionData.bankFee*b._ORDER_FEE_BASE_POINTS*t/this.makingAmount}isExclusiveResolver(t){return this.fusionExtension.postInteractionData.isExclusiveResolver(t)}isExclusivityPeriod(t=(0,g.z)()){return this.fusionExtension.postInteractionData.isExclusivityPeriod(t)}}b._ORDER_FEE_BASE_POINTS=10n**15n,b.defaultExtra={allowPartialFills:!0,allowMultipleFills:!0,unwrapWETH:!1,enablePermit2:!1,orderExpirationDelay:12n};i(67624)},45230:function(t,e,i){i.d(e,{kL:function(){return n.kL},rI:function(){return r.rI},hj:function(){return n.hj},Ot:function(){return r.Ot},Bz:function(){return r.Bz},U4:function(){return n.U4},y9:function(){return n.y9},Kz:function(){return o.Kz},zc:function(){return r.FM},WM:function(){return s.WM},ZX:function(){return o.ZX},R6:function(){return a.R6},zO:function(){return l.z},Hu:function(){return n.Hu}});var n=i(2332),r=i(47607),s=(i(33203),i(59201)),a=i(23174),o=i(1343),l=i(8986);const d=["order_created","order_invalid","order_balance_or_allowance_change","order_filled","order_filled_partially","order_cancelled"];class c{constructor(t){this.provider=t}onOrder(t){this.provider.onMessage((e=>{d.includes(e.event)&&t(e)}))}onOrderCreated(t){this.provider.onMessage((e=>{"order_created"===e.event&&t(e)}))}onOrderInvalid(t){this.provider.onMessage((e=>{"order_invalid"===e.event&&t(e)}))}onOrderBalanceOrAllowanceChange(t){this.provider.onMessage((e=>{"order_balance_or_allowance_change"===e.event&&t(e)}))}onOrderFilled(t){this.provider.onMessage((e=>{"order_filled"===e.event&&t(e)}))}onOrderCancelled(t){this.provider.onMessage((e=>{"order_cancelled"===e.event&&t(e)}))}onOrderFilledPartially(t){this.provider.onMessage((e=>{"order_filled_partially"===e.event&&t(e)}))}}var u=i(44270);class h{constructor(t){this.provider=t}onPong(t){this.provider.onMessage((e=>{"ping"===e.method&&t(e.result)}))}ping(){this.provider.send({method:"ping"})}getActiveOrders({limit:t,page:e}={}){const i=new u.L(e,t).validate();if(i)throw new Error(i);this.provider.send({method:"getActiveOrders",param:{limit:t,page:e}})}onGetActiveOrders(t){this.provider.onMessage((e=>{"getActiveOrders"===e.method&&t(e.result)}))}getAllowedMethods(){this.provider.send({method:"getAllowedMethods"})}onGetAllowedMethods(t){this.provider.onMessage((e=>{"getAllowedMethods"===e.method&&t(e.result)}))}}var m=i(77590);class g{constructor(t){if("url"in(e=t)&&"network"in e){const e=`${function(t){return t.startsWith("http")?t.replace("http","ws"):t}(t.url)}/${g.Version}/${t.network}`,i={...t,url:e},n=new m.W(i);return this.provider=n,this.rpc=new h(n),void(this.order=new c(n))}var e;this.provider=t,this.rpc=new h(t),this.order=new c(t)}static new(t){return new g(t)}init(){this.provider.init()}on(t,e){this.provider.on(t,e)}off(t,e){this.provider.off(t,e)}onOpen(t){this.provider.onOpen(t)}send(t){this.provider.send(t)}close(){this.provider.close()}onMessage(t){this.provider.onMessage(t)}onClose(t){this.provider.onClose(t)}onError(t){this.provider.onError(t)}}g.Version="v2.0";i(68715),i(26045)},23174:function(t,e,i){i.d(e,{KD:function(){return l},R6:function(){return o}});i(2332);var n=i(27550),r=(i(70159),i(75899));new n.vU(r);i(26045),i(57994);const s=100000n,a=s/10000n;function o(t){return t?BigInt(t)*a:0n}function l(t,e){return t+t*e/s}},8986:function(t,e,i){function n(){return BigInt(Math.floor(Date.now()/1e3))}i.d(e,{z:function(){return n}})}}]);
//# sourceMappingURL=5230-2c50ffbc33125935.js.map